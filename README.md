# Support Utils v1.0b

**–ü–∞–∫–µ—Ç —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –±—ã—Å—Ç—Ä–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.**  
–°–æ–∑–¥–∞–Ω –¥–ª—è –∑–∞–¥–∞—á —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Windows.

## üîß –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

- –£–ø—Ä–æ—â–∞–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å–µ—Ç–∏ –∏ —Å–∏—Å—Ç–µ–º—ã —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ CLI;
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —Å–±–æ—Ä –ª–æ–≥–æ–≤, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –û–° –∏ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–µ;
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ RDP –≤ –æ–¥–∏–Ω –∫–ª–∏–∫;
- –í–∫–ª—é—á–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö;
- –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `batch`, `reg`, `vbs` –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ.

> [!NOTE]
> –ü—Ä–æ–µ–∫—Ç —Å–ª—É–∂–∏—Ç –∫–∞–∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–µ–º, —Ç–∞–∫ –∏ showcase-–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ CLI-—Ä–µ—à–µ–Ω–∏–π: —Ñ–æ–∫—É—Å –Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å, –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å —Å–∫—Ä–∏–ø—Ç–æ–≤.

## üß© –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–¥ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏;
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ω–µ–ø–æ–ª–∞–¥–æ–∫ —Å —Å–µ—Ç—å—é;
- –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ RDP-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è;
- –°–±–æ—Ä –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è —Ç–∏–∫–µ—Ç–∞;
- –û—á–∏—Å—Ç–∫–∞, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –û–°;
- –û–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏–µ —Å —Ç–µ–º, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Windows —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É.

## üë®‚Äçüíª –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [üîß –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#-–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
- [üß© –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#-—Å—Ü–µ–Ω–∞—Ä–∏–∏-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- [üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#-–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- [üì¶ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç–∞—Ç—É—Å-–ø—Ä–æ–µ–∫—Ç–∞)
- [‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å](#Ô∏è-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è-–∏-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- [üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [üìÑ –°–∫—Ä–∏–ø—Ç—ã –∏ –æ–ø–∏—Å–∞–Ω–∏–µ](#-—Å–∫—Ä–∏–ø—Ç—ã-–∏-–æ–ø–∏—Å–∞–Ω–∏–µ)

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è / –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç     | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                                 |
|-----------------------------|----------------------------------------------------------------------------|
| **Batch (.bat)**            | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, —ç–∫—Å–ø–æ—Ä—Ç, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞       |
| **VBScript (.vbs)**         | –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å COM-–æ–±—ä–µ–∫—Ç–∞–º–∏ Windows               |
| **Windows CLI**             | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç: `ipconfig`, `reg`, `wevtutil`, `tasklist`|
| **REG-—Ñ–∞–π–ª—ã**               | –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–µ—Å—Ç—Ä–∞                                         |
| **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á**       | –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é —á–µ—Ä–µ–∑ `schtasks`                         |
| **–ñ—É—Ä–Ω–∞–ª—ã Windows (Event Logs)** | –°–±–æ—Ä –∏ –∞–Ω–∞–ª–∏–∑ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ `wevtutil`, `Event Viewer`                |
| **WinDbg (–∏–∑ Windows SDK)** | –ê–Ω–∞–ª–∏–∑ –¥–∞–º–ø–æ–≤ –ø–∞–º—è—Ç–∏, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–±–æ–µ–≤                         |
| **WiLogUtl (Windows Kits)** | –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ `.msi` –ª–æ–≥–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏|
| **Git / GitHub**            | –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—É–±–ª–∏–∫–∞—Ü–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞    |

## üì¶ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

> –í–µ—Ä—Å–∏—è `v1.0b` ‚Äî –±–∞–∑–æ–≤—ã–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –≤—ã–ø—É—Å–∫.

- üü¢ –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —É—Ç–∏–ª–∏—Ç –∑–∞–≤–µ—Ä—à–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ Windows 10/11.
- üü° –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π) –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏.
- üîí –°–∫—Ä–∏–ø—Ç—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ä–∞–±–æ—Ç–æ–π KMS-—Å–µ—Ä–≤–µ—Ä–∞, –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –≤ —Ü–µ–ª—è—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –≤–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —Å–±–æ—è —É–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ Windows 10/11, –≤–µ—Ä—Å–∏–∏ IoT –∏ Pro.
- –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —É—Ç–∏–ª–∏—Ç —Ç—Ä–µ–±—É—é—Ç—Å—è **–ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**.
- **Windows 7, Windows Server –∏ —É—Ä–µ–∑–∞–Ω–Ω—ã–µ —Å–±–æ—Ä–∫–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, Windows 11 S) –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.
- –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ **PowerShell** (v5.0+), **WMI**, –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç Windows CLI (`ipconfig`, `schtasks`, `wevtutil`, `reg`, `tasklist` –∏ –¥—Ä.).
- –£—Ç–∏–ª–∏—Ç—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Å–ª—É–∂–±: –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ `Remote Registry`, `VSS`, `System Restore`, `WLAN Autoconfig` –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤–æ–∑–º–æ–∂–Ω—ã —Å–±–æ–∏.
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—á—ë—Ç—ã `batteryreport`, `sleepstudy`) –¥–æ—Å—Ç—É–ø–Ω—ã **—Ç–æ–ª—å–∫–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö —Å –±–∞—Ç–∞—Ä–µ–µ–π** –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Modern Standby.
- –í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–∂—ë—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ –ø—É—Ç–∏** (`C:\backup`, `C:\Logs`, `%TEMP%`) ‚Äî –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã –≤—Ä—É—á–Ω—É—é.
- **–ê–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å BAT/VBS-—Ñ–∞–π–ª—ã ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–ª–∏ whitelisting.
- –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –≤—ã–≤–æ–¥–æ–º —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞, –æ—Ç–ª–∏—á–Ω–∞—è –æ—Ç UTF-8.

> [!IMPORTANT]
> –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è –∏ –æ–±—É—á–∞—é—â–∏—Ö —Ü–µ–ª–µ–π. –ü–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –≤ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–π —Å—Ä–µ–¥–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–≤—å—é –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
> [!Note]
> –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç —Ü–µ–ª–∏–∫–æ–º –∏–ª–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ —á–µ—Ä–µ–∑ Git.

### –í–∞—Ä–∏–∞–Ω—Ç 1: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ ZIP-–∞—Ä—Ö–∏–≤–∞
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: [GitHub ‚Üí Support Utils ‚Üí Releases](https://github.com/MrWindowsD/support-utils/releases/tag/Utils);
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∞ **Support_Utils_v1.0b.rar**;
3. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤ –≤ —É–¥–æ–±–Ω–æ–µ –º–µ—Å—Ç–æ;
4. –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –≥–æ—Ç–æ–≤—ã –∫ –∑–∞–ø—É—Å–∫—É. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –∏—Ö –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Git
> –¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Git. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç](https://git-scm.com/download/win) –∏–ª–∏ –∫–æ–º–∞–Ω–¥–æ–π:
```
winget install Git.Git
```

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
git clone https://github.com/MrWindowsD/support-utils.git C:\SupportUtils
```
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥:
```bash
C:\Users\NameUser\SupportUtils
```
3. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –Ω—É–∂–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã: `network_diag.bat`, `pre_diag.bat`, `AutoBackupTools\autobackup.bat` –∏ –¥—Ä.

# üìÑ Support Utils
–ù–∞–±–æ—Ä BAT‚Äë—Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∞—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä.

## `network_diag.bat` ‚Äî –±–∞–∑–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–µ—Ç–∏
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
–í—ã–ø–æ–ª–Ω—è–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å–µ—Ç–µ–≤–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã IP-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–Ω–µ—à–Ω–∏—Ö —Ö–æ—Å—Ç–æ–≤, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –º–∞—Ä—à—Ä—É—Ç –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤. –û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è—Ö —Å –∂–∞–ª–æ–±–∞–º–∏ –Ω–∞ –ø–æ—Ç–µ—Ä—é –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, –ø—Ä–æ–±–ª–µ–º—ã —Å DNS –∏–ª–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ GUI.


**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- `ipconfig /all` ‚Äî –≤—ã–≤–æ–¥ –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (IP, DNS, —à–ª—é–∑)
- `ping 8.8.8.8` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–Ω–µ—à–Ω–µ–≥–æ —Ö–æ—Å—Ç–∞ (Google DNS)
- `tracert ya.ru` ‚Äî —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞ –¥–æ —Å–µ—Ä–≤–µ—Ä–∞, –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å –æ–±—Ä—ã–≤
- `netsh winsock reset` ‚Äî —Å–±—Ä–æ—Å —Å–µ—Ç–µ–≤–æ–≥–æ —Å—Ç–µ–∫–∞ (–∏–Ω–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏)
- `netsh wlan show interfaces` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ Wi-Fi-—Å–æ—Å—Ç–æ—è–Ω–∏—è

---

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ |
|-----------------|-------------------------|
| `@chcp 65001 >nul` | –ü–µ—Ä–µ–≤–æ–¥ –∫–æ–Ω—Å–æ–ª–∏ –≤ UTF-8. –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫—Ä–∞–∫–æ–∑—è–±—Ä—ã –ø—Ä–∏ –≤—ã–≤–æ–¥–µ —Ä—É—Å—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤. –ï—Å–ª–∏ –∫–æ–Ω—Å–æ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ANSI (chcp 866), –ø—É—Ç—å —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å —Å–∫—Ä–∏–ø—Ç. |
| `powershell -Command "Get-NetAdapter \| Restart-NetAdapter"` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ç–µ–≤–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞ –±–µ–∑ GUI. –ü–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ –∞–¥–∞–ø—Ç–µ—Ä –∑–∞–≤–∏—Å. |
| `ping -n 3 -l 65500 %site%` | –û—Ç–ø—Ä–∞–≤–∫–∞ "—Ç—è–∂—ë–ª—ã—Ö" –ø–∞–∫–µ—Ç–æ–≤. –ò–Ω–æ–≥–¥–∞ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞–º–∏. |
| `tracert -d -h 10 -w 1000` | –ë–µ–∑ DNS, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ö–æ–ø–æ–≤ –∏ —Ç–∞–π–º–∞—É—Ç–∞–º. –†–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –º–æ–∂–µ—Ç –Ω–µ –≤—ã—è–≤–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —É–∑–ª—ã. |
| `netsh wlan stop hostednetwork` | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π Wi-Fi-—Å–µ—Ç–∏. –ü—Ä–∏–º–µ–Ω–∏–º–æ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏ —Ä–∞–∑–¥–∞—á–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. |

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:**
```bat
@echo off
chcp 65001 >nul
set "log=%TEMP%\network_report.txt"
ipconfig /all >> "%log%"
ping 8.8.8.8 -n 4 >> "%log%"
tracert ya.ru >> "%log%"
start notepad "%log%"
```
<details>
<summary>üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π BAT-—Å–∫—Ä–∏–ø—Ç</summary>

```bat
@echo off
@chcp 65001 >nul

echo Made by MrWindows
echo.
echo ===========================
echo –ù–∞—á–∏–Ω–∞–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å–µ—Ç–µ–≤–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞...
echo ===========================
echo.
title –°–µ—Ç–µ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
color 0A

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞! –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
    pause
    exit /b 1
)

:menu
cls
echo 1. –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
echo 2. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–µ—Ç–∏ (–≤—ã–±–æ—Ä —Å–∞–π—Ç–∞)
echo 3. –í—ã—Ö–æ–¥
choice /c 123 /n /m "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: "
if errorlevel 3 exit
if errorlevel 2 goto site_menu
if errorlevel 1 goto reset

:reset
echo –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤...
powershell -Command "Get-NetAdapter | Restart-NetAdapter -Confirm:$false"

echo –í–∫–ª—é—á–µ–Ω–∏–µ —Å–ª—É–∂–±—ã WLAN AutoConfig...
sc config Wlansvc start= auto
net start Wlansvc

echo –°–±—Ä–æ—Å —Å–µ—Ç–µ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫...
netsh winsock reset catalog
netsh int ip reset
ipconfig /release
ipconfig /renew
ipconfig /flushdns

echo.
echo –û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Å—Ç–µ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.
echo –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä.
echo.
pause
goto menu

:site_menu
cls
echo –í—ã–±–µ—Ä–∏—Ç–µ —Å–∞–π—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
echo 1. vk.com
echo 2. mail.ru
echo 3. web.telegram.org
echo 4. yandex.ru
echo 5. –ù–∞–∑–∞–¥
choice /c 12345 /n /m "–í–∞—à –≤—ã–±–æ—Ä: "
if errorlevel 5 goto menu
if errorlevel 4 set "site=yandex.ru" && goto diagnostics
if errorlevel 3 set "site=web.telegram.org" && goto diagnostics
if errorlevel 2 set "site=mail.ru" && goto diagnostics
if errorlevel 1 set "site=vk.com" && goto diagnostics

:diagnostics
cls
echo.
echo =================================
echo –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ %site%
echo =================================

echo [–ü–∏–Ω–≥ (4 –∑–∞–ø—Ä–æ—Å–∞)]:
ping -n 4 %site% | findstr /i "loss"

echo.
echo [–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ (–¥–æ 10 —Ö–æ–ø–æ–≤)]:
tracert -d -h 10 -w 1000 "%site%"

echo.
echo [–û—Ü–µ–Ω–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ (3 –ø–∞–∫–µ—Ç–∞ –ø–æ 64KB)]:
ping -n 3 -l 65500 %site% | findstr /i "loss"

echo.
echo –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
pause
goto site_menu
```

</details>

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞: Windows 10 –∏ 11;
- –£—á–∏—Ç—ã–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º –∞–¥–∞–ø—Ç–µ—Ä–æ–º –∏ –¥–ª–∏–Ω–Ω—ã–º–∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏;

> [!WARNING]
> 1. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ICMP –∏–∑-–∑–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ñ–∞–µ—Ä–≤–æ–ª–∞: –º–Ω–æ–≥–∏–µ —Å–∞–π—Ç—ã –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç ICMP‚Äë—ç—Ö–æ, –ø–æ—ç—Ç–æ–º—É –¥–∞–∂–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Å–∞–π—Ç –º–æ–∂–µ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ ping/tracert.
> 2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞–∫–µ—Ç–æ–≤ –±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞: `ping -l 65500` —Ç—Ä–µ–±—É–µ—Ç –ø—Ä—è–º–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –º–æ–≥—É—Ç –∑–∞–ø—Ä–µ—â–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä—ã –∏–ª–∏ DNS CDN. –ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä—å –º–æ–∂–µ—Ç –∑–∞—Ç—É—à–µ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Å—É—Ç—å.
> 3. –¢—Ä—ç–π—Å–µ—Ä—É—Ç –Ω–µ –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç: –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TTL, –Ω–æ –µ—Å–ª–∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç ICMP ¬´Time exceeded¬ª, —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞ —ç—Ç–æ–º –º–µ—Å—Ç–µ –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è.
> 4. –¢–∞–π–º-–∞—É—Ç—ã –∏ –µ–¥–∏–Ω–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: –æ—Ç–≤–µ—Ç–∞ –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –∏–∑-–∑–∞ —Å–µ—Ç–µ–≤–æ–π –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞ ‚Äî —ç—Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–∑–Ω–∞—á–∞–µ—Ç –æ–±—Ä—ã–≤ —Å–≤—è–∑–∏.

## `pre_diag.bat` ‚Äî –±–∞–∑–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –û–° Windows

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ Windows: –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ DISM, –ø—Ä–æ–≤–µ—Ä–∫—É —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (`sfc`) –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –¥–∏—Å–∫–∞ (`chkdsk`). –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –æ–∫–Ω–µ –∫–æ–Ω—Å–æ–ª–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É `C:\Logs`.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–±–æ–µ–≤, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø–µ—Ä–µ–¥ —Ç–∏–∫–µ—Ç–æ–º –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ü–ö –∫ –ø–µ—Ä–µ–Ω–æ—Å—É –∏–ª–∏ –º–∞—Å—Å–æ–≤–æ–º—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é. –û—Å–æ–±–µ–Ω–Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ BDOS, –æ—à–∏–±–æ–∫ —Å–ª—É–∂–±, –∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
* `DISM /Online /Cleanup-Image /RestoreHealth` ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞ Windows;
* `sfc /scannow` ‚Äî —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤;
* `chkdsk C: /f /r` ‚Äî –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–º –¥–∏—Å–∫–µ;
* `mkdir`, `set`, `if errorlevel` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –æ—à–∏–±–æ–∫.

---

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å                                         | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                                       |
| ------------------------------------------------- | ---------------------------------------------------------------------------- |
| `@chcp 65001`                                     | –ü–µ—Ä–µ–≤–æ–¥ –∫–æ–Ω—Å–æ–ª–∏ –≤ UTF-8. –ò—Å–∫–ª—é—á–∞–µ—Ç –∏—Å–∫–∞–∂–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤ –≤ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω–æ–π —Å—Ä–µ–¥–µ. |
| `if not exist "%LOG_DIR%" ( mkdir "%LOG_DIR%" )`  | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –¥–ª—è –ª–æ–≥–æ–≤                                   |
| `powershell -ExecutionPolicy ByPass -Command ...` | –û–±—Ö–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π PowerShell-–ø–æ–ª–∏—Ç–∏–∫–∏, –∑–∞–ø—É—Å–∫ DISM                           |
| `wevtutil qe System ... Level=2`                  | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ —É—Ä–æ–≤–Ω—è *Critical/Error*                                    |
| `systeminfo >> –ª–æ–≥`                               | –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–º–ø–∞ –û–° –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ                                       |
| `if errorlevel (...) else (...)`                  | –ö–æ–Ω—Ç—Ä–æ–ª—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ —Å fallback-–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–æ–π           |

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:**

```bat
@echo off
@chcp 65001
set LOG_DIR=C:\Logs
set CHKSUM_FILENAME=chkdsk_log.txt
set DUMP_FILENAME=dump_log.txt

if not exist "%LOG_DIR%" (
    mkdir "%LOG_DIR%"
)

:: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
powershell -ExecutionPolicy ByPass -Command "Dism /Online /Cleanup-Image /RestoreHealth"

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
sfc /scannow

:: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∂—ë—Å—Ç–∫–æ–≥–æ –¥–∏—Å–∫–∞
chkdsk C: /f /r

:: –ü–∞—Ä—Å–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞ –Ω–∞ –æ—à–∏–±–∫–∏
wevtutil qe System "/q:*[System[Level=2]]" /f:text > event_log_report.txt

:: –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–º–ø–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
systeminfo >> "%LOG_DIR%\%DUMP_FILENAME%"

```

<details>
<summary>üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π BAT-—Å–∫—Ä–∏–ø—Ç</summary>

```bat
rem –æ—Ç MrWindows
@echo off
@chcp 65001
set LOG_DIR=C:\Logs
set CHKSUM_FILENAME=chkdsk_log.txt
set DUMP_FILENAME=dump_log.txt

if not exist "%LOG_DIR%" (
    mkdir "%LOG_DIR%"
)
echo Made by MrWindows
echo.
echo ===========================
echo –ù–∞—á–∏–Ω–∞–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –û–°...
echo ===========================
echo.
echo –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ DISM...
powershell -ExecutionPolicy ByPass -Command "Dism /Online /Cleanup-Image /RestoreHealth"
if errorlevel 1 (
    echo –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è DISM.
) else (
    echo DISM –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
)
echo.
echo System File Checke...
echo –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤...
sfc /scannow
if errorlevel 1 (
    echo –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
) else (
    echo –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
)
echo.
echo –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –¥–∏—Å–∫–∞...
echo –ó–∞–ø—É—Å–∫ chkdsk —Å —Ñ–ª–∞–≥–∞–º–∏ /f –∏ /r. –í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.
chkdsk C: /f /r
if errorlevel 1 (
    echo –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã chkdsk.
) else (
    echo –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!
)

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ —Å–æ–±—ã—Ç–∏–π
echo.
echo –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ —Å–æ–±—ã—Ç–∏–π –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫...
wevtutil qe System "/q:*[System[Level=2]]" /f:text > event_log_report.txt
echo –û—à–∏–±–∫–∏ –∏–∑ –∂—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π –∑–∞–ø–∏—Å–∞–Ω—ã –≤ event_log_report.txt

echo –°–æ–∑–¥–∞–µ–º –¥–∞–º–ø –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏...
echo ===========================
echo –î–∞–º–ø —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ > "%LOG_DIR%\%DUMP_FILENAME%"
systeminfo >> "%LOG_DIR%\%DUMP_FILENAME%"
echo –î–∞–º–ø –∑–∞–≤–µ—Ä—à–µ–Ω, –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ "%LOG_DIR%\%DUMP_FILENAME%".
echo ===========================

echo.
echo –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∏—Å—Ç–µ–º—É. 
pause
```

</details>

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞: Windows 10 –∏ Windows 11;
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –û–° ‚Äî –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö —É—Ç–∏–ª–∏—Ç;
- –í—Å–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É C:\Logs (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏);
- –û–ø–æ–≤–µ—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞;
- –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É.

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**

1. **–§–∞–π–ª—ã:**
    - `%LOG_DIR%\%DUMP_FILENAME%` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π –¥–∞–º–ø;
    - `event_log_report.txt` ‚Äî –≤—ã–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ—à–∏–±–æ–∫.
2. **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ª–æ–≥–æ–≤:**
    - `systeminfo`: —Å–±–æ—Ä–∫–∞ –û–°, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ø–∞–º—è—Ç—å, –∞–ø—Ç–∞–π–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è;
    - `wevtutil`: –æ—à–∏–±–∫–∏ —è–¥—Ä–∞, –¥—Ä–∞–π–≤–µ—Ä–æ–≤, —Å–ª—É–∂–±.
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `if errorlevel` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ (`DISM`, `sfc`, `chkdsk`)
  
### –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –∏ –¥–∞–º–ø–æ–≤

#### 1. –ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–æ–≥–æ–≤ (—á–µ—Ä–µ–∑ `event_log_report.txt`)

–õ–æ–≥–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑:
```bat
wevtutil qe System "/q:*[System[Level=2]]" /f:text > event_log_report.txt
````
<img width="1777" height="938" alt="event_log" src="https://github.com/user-attachments/assets/4fc8c117-7f26-481e-aac5-d4d129247ec2" />

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —É—Ä–æ–≤–Ω—è `Critical` –∏ `Error` –∏–∑ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞ Windows.

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∞–Ω–∞–ª–∏–∑–∞:**
* –û–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ **Event ID** –∏ **Source** ‚Äî –æ–Ω–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Ç–∏–ø —Å–±–æ—è.
* –°–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ **–≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è** –∏ **–ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å** ‚Äî –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å.
* –°–æ–ø–æ—Å—Ç–∞–≤–ª—è—Ç—å –æ—à–∏–±–∫–∏ —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –º–æ–º–µ–Ω—Ç–∞–º–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞ (—Ñ—Ä–∞–≥–º–µ–Ω—Ç):**

```text
Event[2128]:
  Log Name: System
  Source: Disk
  Date: 2024-08-01T13:05:12.1230000Z
  Event ID: 7
  Task: None
  Level: Error
  Opcode: Info
  Message: The device, \Device\Harddisk0\DR0, has a bad block.
```

* **Source: Disk**, **Event ID: 7** ‚Äî –æ—à–∏–±–∫–∞ –∂—ë—Å—Ç–∫–æ–≥–æ –¥–∏—Å–∫–∞, –≤–æ–∑–º–æ–∂–µ–Ω —Å–±–æ–π —á—Ç–µ–Ω–∏—è.
* –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å SMART-—Å—Ç–∞—Ç—É—Å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É `chkdsk`.

–¢–∞–∫–∂–µ —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—ë—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–∞–º–ø `dump_log` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø–µ—Ä–≤–∏—á–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.

<details>
<summary>üîç –ü—Ä–∏–º–µ—Ä dump_log</summary>

```log
–î–∞–º–ø —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ 

Host Name:                ***
OS Name:                   –ú–∞–π–∫—Ä–æ—Å–æ—Ñ—Ç Windows 11 Pro
OS Version:                10.0.22631 N/A Build 22631
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Workstation
OS Build Type:             Multiprocessor Free
Registered Owner:          ***
Registered Organization:   
Product ID:                ***
Original Install Date:     18.02.2024, 23:19:51
System Boot Time:          05.08.2025, 15:10:44
System Manufacturer:       ASUS
System Model:              All Series
System Type:               x64-based PC
Processor(s):              1 Processor(s) Installed.
                           [01]: Intel64 Family 6 Model 63 Stepping 2 GenuineIntel ~2304 Mhz
BIOS Version:              American Megatrends Inc. 2101, 10.07.2019
Windows Directory:         C:\Windows
System Directory:          C:\Windows\system32
Boot Device:               \Device\HarddiskVolume1
System Locale:             ru;Russian
Input Locale:              ru;Russian
Time Zone:                 (UTC+03:00) Moscow, St. Petersburg
Total Physical Memory:     32¬†682 MB
Available Physical Memory: 19¬†761 MB
Virtual Memory: Max Size:  70¬†570 MB
Virtual Memory: Available: 50¬†418 MB
Virtual Memory: In Use:    20¬†152 MB
Page File Location(s):     C:\pagefile.sys
                           H:\pagefile.sys
Domain:                    WORKGROUP
Logon Server:              \\***
Hotfix(s):                 6 Hotfix(s) Installed.
                           [01]: KB5056580
                           [02]: KB5027397
                           [03]: KB5033055
                           [04]: KB5062552
                           [05]: KB5058546
                           [06]: KB5063707
Network Card(s):           6 NIC(s) Installed.
                           [01]: Intel(R) Ethernet Connection (2) I218-V
                                 Connection Name: Ethernet
                                 DHCP Enabled:    Yes
                                 DHCP Server:     192.168.50.1
                                 IP address(es)
                                 [01]: 111.111.11.1
                                 [02]: ffff::ffff:ffff:ffff:ffff
                           [02]: TAP-Windows Adapter V9
                                 Connection Name: Ethernet 2
                                 Status:          Media disconnected
                           [03]: OpenVPN Data Channel Offload
                                 Connection Name: OpenVPN Data Channel Offload
                                 Status:          Media disconnected
                           [04]: TAP-Windows Adapter V9
                                 Connection Name: Ethernet 4
                                 Status:          Media disconnected
                           [05]: VMware Virtual Ethernet Adapter for VMnet1
                                 Connection Name: VMware Network Adapter VMnet1
                                 DHCP Enabled:    Yes
                                 DHCP Server:     192.168.126.254
                                 IP address(es)
                                 [01]: 111.111.11.1
                                 [02]: ffff::ffff:ffff:ffff:ffff
                           [06]: VMware Virtual Ethernet Adapter for VMnet8
                                 Connection Name: VMware Network Adapter VMnet8
                                 DHCP Enabled:    Yes
                                 DHCP Server:     192.168.174.254
                                 IP address(es)
                                 [01]: 111.111.11.1
                                 [02]: ffff::ffff:ffff:ffff:ffff
Hyper-V Requirements:      VM Monitor Mode Extensions: Yes
                           Virtualization Enabled In Firmware: Yes
                           Second Level Address Translation: Yes
                           Data Execution Prevention Available: Yes

```

</details>

#### 2. –ê–Ω–∞–ª–∏–∑ –¥–∞–º–ø–æ–≤ —á–µ—Ä–µ–∑ `WinDbg`

**–ß—Ç–æ —Ç–∞–∫–æ–µ WinDbg?**
**WinDbg** ‚Äî —ç—Ç–æ –æ—Ç–ª–∞–¥—á–∏–∫ –æ—Ç Microsoft, –≤—Ö–æ–¥—è—â–∏–π –≤ —Å–æ—Å—Ç–∞–≤ Windows SDK. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–º–ø–æ–≤ –ø–∞–º—è—Ç–∏, BSOD, —Å–±–æ–µ–≤ —è–¥—Ä–∞ –∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤.

<img width="1719" height="869" alt="DbgX Shell_LvxEwYdZSG" src="https://github.com/user-attachments/assets/3a45ba23-62fb-4242-8980-e42e07c83e35" />

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**

1. –°–∫–∞—á–∞–π—Ç–µ Windows SDK —Å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞](https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/);
2. –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ **–æ—Ç–º–µ—Ç—å—Ç–µ —Ç–æ–ª—å–∫–æ "Debugging Tools for Windows"** (WinDbg);
3. –ü–æ—Å–ª–µ —á–µ–≥–æ –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–∞–º–ø: `File ‚Üí Open Crash Dump ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ .dmp —Ñ–∞–π–ª`.

**–û—Ç–∫—É–¥–∞ –±–µ—Ä—ë—Ç—Å—è –¥–∞–º–ø?**
–§–∞–π–ª —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.dmp` —Å–æ–∑–¥–∞—ë—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**, –∫–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–ª–∫–∏–≤–∞–µ—Ç—Å—è —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–æ–π, –∏ –≤–∫–ª—é—á–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–º–ø–∞:

- –ü–æ–ª–Ω—ã–π –¥–∞–º–ø: `C:\Windows\MEMORY.DMP`
- –ú–∏–Ω–∏–¥–∞–º–ø—ã: `%SystemRoot%\Minidump\*.dmp`

–ï—Å–ª–∏ BSOD –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–º–ø—ã:
- –û—Ç–∫—Ä–æ–π—Ç–µ **–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Üí –°–∏—Å—Ç–µ–º–∞ ‚Üí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º—ã ‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ "–ó–∞–ø–∏—Å—å –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏" ‚Üí **–ú–∞–ª—ã–π –¥–∞–º–ø –ø–∞–º—è—Ç–∏ (256 –ö–ë)**

**–ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

- ```!analyze -v``` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç—á—ë—Ç –ø–æ —Å–±–æ—é;
- ```lm``` ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π (–¥—Ä–∞–π–≤–µ—Ä–æ–≤);
- ```kv``` ‚Äî —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤.

**–ü—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–º–ø–∞:**

```text
BugCheck 1A, {41792, fffff68000012340, 8000000000000000, 0}

Probably caused by : ntkrnlmp.exe ( nt! ?? ::FNODOBFM::`string'+3618d )

PROCESS_NAME: chrome.exe
```

* **BugCheck 1A** ‚Äî –æ—à–∏–±–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é (MEMORY\_MANAGEMENT);
* **chrome.exe** ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–∏–Ω–æ–≤–Ω–∏–∫;
* **ntkrnlmp.exe** ‚Äî —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, –æ—à–∏–±–∫–∞ –≤ –¥—Ä–∞–π–≤–µ—Ä–µ/–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏.

> \[!NOTE]
> –ü–æ `BugCheck` –∏ `Event ID` –º–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –≤ –±–∞–∑–µ Microsoft:
> [https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/bug-check-code-reference2](https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/bug-check-code-reference2)

<details>
<summary>üîç –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞</summary>

```log
KEY_VALUES_STRING: 1

    Key  : AV.Dereference
    Value: NullPtr

    Key  : AV.Fault
    Value: Read

    Key  : Analysis.CPU.mSec
    Value: 578

    Key  : Analysis.Elapsed.mSec
    Value: 68368

    Key  : Analysis.IO.Other.Mb
    Value: 64

    Key  : Analysis.IO.Read.Mb
    Value: 1

    Key  : Analysis.IO.Write.Mb
    Value: 86

    Key  : Analysis.Init.CPU.mSec
    Value: 46

    Key  : Analysis.Init.Elapsed.mSec
    Value: 27288

    Key  : Analysis.Memory.CommitPeak.Mb
    Value: 135

    Key  : Analysis.Version.DbgEng
    Value: 10.0.27725.1000

    Key  : Analysis.Version.Description
    Value: 10.2408.27.01 amd64fre

    Key  : Analysis.Version.Ext
    Value: 1.2408.27.1

    Key  : Failure.Bucket
    Value: NULL_POINTER_READ_c0000005_acad.exe!Unknown

    Key  : Failure.Hash
    Value: {33e1f895-55a8-b4bc-c76f-1263f4f312ab}

    Key  : Timeline.Process.Start.DeltaSec
    Value: 4

    Key  : WER.Process.Version
    Value: 30.1.51.0


FILE_IN_CAB:  acadminidump.dmp

CONTEXT:  (.ecxr)
rax=0000000000000000 rbx=00007ff7f8e39150 rcx=0000000000000000
rdx=00007ff7f8e39180 rsi=0000000000000000 rdi=00007ff7f8e35930
rip=00007ff7f89f9c85 rsp=000000e40f9ff600 rbp=000000e40f9ff699
 r8=000002c1172c15c0  r9=0000000000000001 r10=0000000000000003
r11=000000e40f9ff4f0 r12=00007ff7f8e35930 r13=0000000000000000
r14=0000000000000000 r15=0000000000000001
iopl=0         nv up ei pl nz na po nc
cs=0033  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010206
acad!AcApDocWindowManager::newIterator+0x135:
00007ff7`f89f9c85 4c8b00          mov     r8,qword ptr [rax] ds:00000000`00000000=????????????????
Resetting default scope

EXCEPTION_RECORD:  (.exr -1)
ExceptionAddress: 00007ff7f89f9c85 (acad!AcApDocWindowManager::newIterator+0x0000000000000135)
   ExceptionCode: c0000005 (Access violation)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 0000000000000000
   Parameter[1]: 0000000000000000
Attempt to read from address 0000000000000000

PROCESS_NAME:  acad.exe

READ_ADDRESS:  0000000000000000 

ERROR_CODE: (NTSTATUS) 0xc0000005 -                      0x%p                               0x%p.                      %s.

EXCEPTION_CODE_STR:  c0000005

EXCEPTION_PARAMETER1:  0000000000000000

EXCEPTION_PARAMETER2:  0000000000000000

STACK_TEXT:  
000000e4`0f9ff600 00007ff7`f89e053b     : 00000000`00000000 00007ff7`f8cc1190 000000e4`0f9ff699 00007ff7`f8e35930 : acad!AcApDocWindowManager::newIterator+0x135
000000e4`0f9ff630 00007ffb`d2c52bf0     : 00000000`00000001 00000000`00000001 00000000`00000000 000002c1`173c7e30 : acad!getAcLicenseSettings+0x6feb
000000e4`0f9ff700 00007ff7`f8a09602     : 00000000`00000001 00000000`00000000 00000000`00000000 00000000`00000000 : mfc140u!AfxWinMain+0xc0
000000e4`0f9ff740 00007ffc`10ba259d     : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : acad!AcMenuIconLibrary::operator=+0xaa32
000000e4`0f9ff780 00007ffc`1190af38     : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : kernel32!BaseThreadInitThunk+0x1d
000000e4`0f9ff7b0 00000000`00000000     : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : ntdll!RtlUserThreadStart+0x28


STACK_COMMAND:  ~0s; .ecxr ; kb

SYMBOL_NAME:  acad+135

MODULE_NAME: acad

IMAGE_NAME:  acad.exe

FAILURE_BUCKET_ID:  NULL_POINTER_READ_c0000005_acad.exe!Unknown

OSPLATFORM_TYPE:  x64

OSNAME:  Windows 10

IMAGE_VERSION:  30.1.51.0

FAILURE_ID_HASH:  {33e1f895-55a8-b4bc-c76f-1263f4f312ab}

Followup:     MachineOwner
```

<img width="1920" height="1009" alt="DbgX Shell_IFxsxONTN7" src="https://github.com/user-attachments/assets/19c7444a-0ca1-4990-82cb-7e52fca59fa2" />

</details>

---

> \[!WARNING]
> 1. `chkdsk` ‚Äî –ø–æ—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É —Å–∏—Å—Ç–µ–º—ã;
> 2. `DISM` —Ç—Ä–µ–±—É–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è;
> 3. `sfc` –º–æ–∂–µ—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫–∞–∑–∞—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏, –µ—Å–ª–∏ –æ—à–∏–±–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Äî –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `CBS.log`;

## `office_profile_export.bat` ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è Office

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
–°—Ü–µ–Ω–∞—Ä–∏–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–¥—Ö–æ–¥ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ä–µ–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Microsoft Office –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –¥–∏—Å–∫—É. –û—Å–Ω–æ–≤–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª–µ–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ, –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—é —Ä–µ–µ—Å—Ç—Ä–∞ ‚Äî –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –ü–û.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
–°–∫—Ä–∏–ø—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∫–∞–∫ **–ø—Ä–∏–º–µ—Ä –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏**, –ø—Ä–∏–º–µ–Ω–∏–º—ã–π –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–µ–π—Å–∞—Ö:

* –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è;
* –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ –¥–ª—è —á–∞—Å—Ç–∏—á–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ –ü–ö;
* –ú–∏–≥—Ä–∞—Ü–∏—è —Ä–µ–µ—Å—Ç—Ä–æ–≤—ã—Ö –∏ —Ñ–∞–π–ª–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Microsoft Office (–∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã) –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è. 

–ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –ø–æ—Å–ª–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∏—Å–∫–∞, –ª–∏–±–æ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è –≤—Ä—É—á–Ω—É—é.

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

* `robocopy` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–∞–ø–æ–∫ Office;
* `reg export` ‚Äî —ç–∫—Å–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏–∑ –≤–µ—Ç–æ–∫ `HKCU` –∏ `HKLM`;
* `md` ‚Äî —Ä—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ–º—ã—Ö –ø—É—Ç–µ–π (`AppData`, `ProgramData`, `Templates`);
* `set` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è –ø—É—Ç–µ–π –∏ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞;
* `if not exist (...) exit /b` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `H:\` ‚Äî –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–π –¥–∏—Å–∫).

---

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å                                      | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                                                                                                                                          |
| ---------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `@chcp 866 >nul`                               | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ OEM-–∫–æ–¥–∏—Ä–æ–≤–∫–∏ (CP866) –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–º–∏ –ø—É—Ç—è–º–∏ –∏ –∏–º–µ–Ω–∞–º–∏ —Ñ–∞–π–ª–æ–≤. –ë–µ–∑ –Ω–µ—ë –≤–æ–∑–º–æ–∂–Ω—ã –æ—à–∏–±–∫–∏ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º `C:\–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏` –∏ –ø–æ–¥–æ–±–Ω—ã–º. |
| `if not exist "%SRC%\" (...) exit /b`          | –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–ø—ã—Ç–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–∫–ª—é—á—ë–Ω –¥–∏—Å–∫).                                                                                           |
| `robocopy "%SRC%\..." "%DST%\..." /E /COPYALL` | –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.                                                                                                       |
| `reg export "..." "%REGDIR%\..." /y`           | –≠–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–µ–π —Ä–µ–µ—Å—Ç—Ä–∞, –≤ —Ç–æ–º —á–∏—Å–ª–µ OSPP (Office Software Protection Platform).                                                                                                 |
| `md "%APPDATA%\Microsoft\..." 2>nul`           | –°–æ–∑–¥–∞–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–∞–ø–æ–∫ –±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ.                                                                                           |

---

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:**

```bat
set "SRC=H:"
set "DST=C:"
set "USER=–ò—Ä–∞"

robocopy "%SRC%\Program Files (x86)\Microsoft Office" "%DST%\Program Files (x86)\Microsoft Office" /E
reg export "HKCU\Software\Microsoft\Office\14.0" "%REGDIR%\HKCU_Office14.reg" /y
```

<details>
<summary>üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π BAT-—Å–∫—Ä–∏–ø—Ç</summary>

```bat
@echo off
chcp 866 >nul
setlocal

rem === –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ===
set "SRC=H:"
set "DST=C:"
set "USER=–ò—Ä–∞"
set "REGDIR=%SRC%\OfficeBackup\RegExports"
set "HKCU_REG=%REGDIR%\HKCU_Office14.reg"
set "HKLM_REG=%REGDIR%\HKLM_OSPP.reg"
rem === /–ü–∞—Ä–∞–º–µ—Ç—Ä—ã ===

echo –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∏—Å–∫ %SRC% –¥–æ—Å—Ç—É–ø–µ–Ω...
if not exist "%SRC%\" (
  echo –û–®–ò–ë–ö–ê: %SRC% –Ω–µ –Ω–∞–π–¥–µ–Ω.
  pause & exit /b 1
)

echo –°–æ–∑–¥–∞—ë–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–ø–∫–∏ –Ω–∞ %DST%...
md "%DST%\Program Files (x86)\Microsoft Office"    2>nul
md "%DST%\Program Files\Common Files\Microsoft Shared" 2>nul
md "%DST%\ProgramData\Microsoft\Office"             2>nul
md "%DST%\ProgramData\Microsoft\OfficeSoftwareProtectionPlatform" 2>nul
md "%DST%\Windows\Installer"                        2>nul
md "%APPDATA%\Microsoft\Templates"                  2>nul
md "%APPDATA%\Microsoft\UProof"                     2>nul
md "%APPDATA%\Microsoft\Excel\XLSTART"              2>nul
md "%USERPROFILE%\Documents\Custom Office Templates" 2>nul

echo –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã Office...
robocopy "%SRC%\Program Files (x86)\Microsoft Office"    "%DST%\Program Files (x86)\Microsoft Office"    /MIR /COPYALL /R:2 /W:2
robocopy "%SRC%\Program Files\Common Files\Microsoft Shared" \
        "%DST%\Program Files\Common Files\Microsoft Shared" /MIR /COPYALL /R:2 /W:2
robocopy "%SRC%\ProgramData\Microsoft\Office"             "%DST%\ProgramData\Microsoft\Office"             /MIR /COPYALL /R:2 /W:2
robocopy "%SRC%\ProgramData\Microsoft\OfficeSoftwareProtectionPlatform" \
        "%DST%\ProgramData\Microsoft\OfficeSoftwareProtectionPlatform" /MIR /COPYALL /R:2 /W:2

echo –ö–æ–ø–∏—Ä—É–µ–º –ø–∞–ø–∫—É Windows Installer...
robocopy "%SRC%\Windows\Installer" "%DST%\Windows\Installer" /COPYALL /R:2 /W:2

echo –ö–æ–ø–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (%USER%)...
robocopy "%SRC%\Users\%USER%\AppData\Roaming\Microsoft\Templates" "%APPDATA%\Microsoft\Templates" /MIR /COPYALL /R:2 /W:2
robocopy "%SRC%\Users\%USER%\AppData\Roaming\Microsoft\UProof"    "%APPDATA%\Microsoft\UProof"    /MIR /COPYALL /R:2 /W:2
robocopy "%SRC%\Users\%USER%\AppData\Roaming\Microsoft\Excel\XLSTART" "%APPDATA%\Microsoft\Excel\XLSTART" /MIR /COPYALL /R:2 /W:2
robocopy "%SRC%\Users\%USER%\Documents\Custom Office Templates"    "%USERPROFILE%\Documents\Custom Office Templates" /MIR /COPYALL /R:2 /W:2

echo –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–µ—Å—Ç—Ä Office...
if exist "%HKCU_REG%" (
  reg import "%HKCU_REG%"
) else (
  echo WARNING: –Ω–µ –Ω–∞–π–¥–µ–Ω %HKCU_REG%
)
if exist "%HKLM_REG%" (
  reg import "%HKLM_REG%"
) else (
  echo WARNING: –Ω–µ –Ω–∞–π–¥–µ–Ω %HKLM_REG%
)

echo –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞...
takeown /F "%DST%\Program Files (x86)\Microsoft Office" /R /D Y >nul
icacls  "%DST%\Program Files (x86)\Microsoft Office" /grant "SYSTEM":F "%USER":F /T /C >nul

echo –†–µ–∑–µ—Ä–≤–∏—Ä—É–µ–º —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã –ª–∏—Ü–µ–Ω–∑–∏–∏...
for %%F in (
  "%ProgramData%\Microsoft\OfficeSoftwareProtectionPlatform\tokens.dat"
  "%ProgramData%\Microsoft\OfficeSoftwareProtectionPlatform\Cache\cache.dat"
  "%CommonProgramFiles(x86)%\Microsoft Shared\OFFICE14\Office Setup Controller\pkeyconfig-office.xrm-ms"
) do (
  if exist "%%~F" ren "%%~F" "%%~nF.old"
)

echo –í–≤–µ–¥–∏—Ç–µ Retail/Mak –∫–ª—é—á Office 2010:
set /p "KEY=–ö–ª—é—á (25 —Å–∏–º–≤–æ–ª–æ–≤): "

echo –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–ª—é—á –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º Office...
pushd "%ProgramFiles(x86)%\Microsoft Office\Office14"
cscript //nologo ospp.vbs /inpkey:%KEY%
cscript //nologo ospp.vbs /act
popd

echo –ó–∞–≤–µ—Ä—à–µ–Ω–æ. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥...
timeout /t 10 /nobreak >nul
shutdown /r /f /t 0

endlocal

```
</details>

---

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

* –°–∫—Ä–∏–ø—Ç –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è production-–º–∞—Å—Å–æ–≤–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è, –∞ —Å–ª—É–∂–∏—Ç –∫–∞–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞–≤—ã–∫–æ–≤ –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ CLI;
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —á–∏—Å—Ç—ã–π `batch` –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π;
* –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç –ø–µ—Ä–µ–Ω–æ—Å–∞;
* –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –¥—Ä—É–≥–∏–µ –≤–µ—Ä—Å–∏–∏ Office –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏;
* –ß—ë—Ç–∫–∞—è –ª–æ–≥–∏–∫–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞, —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–æ–∫, —ç–∫—Å–ø–æ—Ä—Ç —Ä–µ–µ—Å—Ç—Ä–∞, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

> \[!WARNING]
>
> 1. –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç **–Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ Office** ‚Äî –æ–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫;
> 2. –ê–∫—Ç–∏–≤–∞—Ü–∏—è Office –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏ —Ç–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–µ–µ—Å—Ç—Ä–æ–≤–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞;
> 3. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—É—Ç–∏ –∂—ë—Å—Ç–∫–æ –∑–∞—à–∏—Ç—ã (`Program Files`, `%APPDATA%`) ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–æ –ø—Ä–∏ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –∏–ª–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∫ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏;
> 4. –°–∫—Ä–∏–ø—Ç —Ç—Ä–µ–±—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –Ω–æ—Å–∏—Ç–µ–ª—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–∏—Å–∫–∞ H:).

## `AutoBackupTools` ‚Äî CLI-–ø–∞–∫–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
CLI-—É—Ç–∏–ª–∏—Ç–∞, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ Windows (**batch** –∏ **VBS**). –ü–∞–∫–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è, –æ—á–∏—Å—Ç–∫–∏ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±—ç–∫–∞–ø–æ–≤, –∞ —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç—É —Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º –∑–∞–¥–∞—á (**Task Scheduler**). –°–∫—Ä–∏–ø—Ç –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–æ–π –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ —à–∞–±–ª–æ–Ω –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö:

* CLI-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è;
* –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ —Å —É—è–∑–≤–∏–º—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏;
* –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ `Task Scheduler`;
* –ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –∏–ª–∏ –æ—Ç–∫–∞–∑–∞ Windows;
* –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ restore-–ø—Ä–æ—Ü–µ—Å—Å–∞ –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —É—Ç–∏–ª–∏—Ç.

**–°–æ—Å—Ç–∞–≤ –ø–∞–∫–µ—Ç–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤:**

| –§–∞–π–ª                         | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                                                                                                         |
| ---------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| `autobackup.bat`             | –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç: –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ `create_services_backup.vbs`.                                   |
| `backupgood.bat`             | –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–∞–π–ª—ã, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –ø–∞–ø–∫–∏ –∏–∑ `%APPDATA%` –∏ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞ –≤ `C:\backup`. |
| `create_services_backup.vbs` | –ß–µ—Ä–µ–∑ COM-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ Windows (`Task Scheduler`) –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ `autobackup.bat`.                          |
| `clearbackupgood.bat`        | –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç –ø–∞–ø–∫—É —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π. **–ù–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–æ—Ä–∞–±–æ—Ç–∫–µ –∏–∑-–∑–∞ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –≤ —Å–∏—Å—Ç–µ–º–µ**. |
| `delet autobackup.bat`       | –£–¥–∞–ª—è–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—É—é –∑–∞–¥–∞—á—É. |

> \[!NOTE]
> –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ: —Å–æ–∑–¥–∞–Ω–∏–µ, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è.
> –í —Å—Ç–∞–¥–∏–∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∏:
>   * `clearbackupgood.bat`: –Ω–µ–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏;
>   * –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä—Ö–∏–≤–æ–≤.

### `autobackup.bat` ‚Äî —É–ø—Ä–∞–≤–ª—è—é—â–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–ø—É—Å–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á

–°–æ–∑–¥–∞—ë—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –∫–æ–ø–∏—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (`*.bat`, `*.vbs`) –≤ —Å–∏—Å—Ç–µ–º–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `C:\startupbackupsystem`, –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ Windows —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º (`onlogon`, `hourly`, `daily`, `weekly`, `monthly`).

---

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

* `xcopy /s` ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ `C:\startupbackupsystem`;
* `takeown /F /R` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é;
* `schtasks /create` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∑–∞–ø—É—Å–∫–∞;
* `set /p`, `goto` ‚Äî –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (onlogon, hourly, daily –∏ –¥—Ä.).

---

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å                                      | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                                                        |
| ---------------------------------------------- | --------------------------------------------------------------------------------------------- |
| `xcopy /s "%~dp0\startup\..." "C:\startup..."` | –ö–æ–ø–∏—Ä—É–µ—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏–∑ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞ —Ä—è–¥–æ–º —Å `autobackup.bat` –≤ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é |
| `schtasks /create /tn "BackupTask"`            | –°–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É –≤ Task Scheduler –Ω–∞ –∑–∞–ø—É—Å–∫ `backupgood.bat`                                    |
| `schtasks /create /tn "ClearBackupTask"`       | –°–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ—á–∏—Å—Ç–∫–∏ `clearbackupgood.bat` –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é                        |
| `takeown /F ... /R`                            | –ü–µ—Ä–µ–¥–∞—ë—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é                        |
| `set /p choice=`                               | –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –∑–∞–ø—É—Å–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∏                                     |

---

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:**

```bat
xcopy /s "%~dp0\startup\backupgood.bat" "C:\startupbackupsystem"
schtasks /create /tn "BackupTask" /sc onlogon /rl HIGHEST /f /tr C:\startupbackupsystem\backupgood.bat /np
```

<details>
<summary>üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π BAT-—Å–∫—Ä–∏–ø—Ç</summary>

```bat
@echo off
echo Batch File by MrWindows

mkdir "C:\startupbackupsystem"
echo.
xcopy /s "%~dp0.\startup\backupgood.bat" "C:\startupbackupsystem"
xcopy /s "%~dp0.\startup\create_services_backup.vbs" "C:\startupbackupsystem"
xcopy /s "%~dp0.\startup\clearbackupgood.bat" "C:\startupbackupsystem"
echo.

takeown /F "C:\startupbackupsystem" /R

:: –ó–∞–ø—Ä–æ—Å –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –∑–∞–ø—É—Å–∫–∞
echo.
echo.
echo –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∑–∞–ø—É—Å–∫–∞ –∑–∞–¥–∞—á–∏:
echo 1. –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)
echo 2. –ö–∞–∂–¥—ã–µ N —á–∞—Å–æ–≤
echo 3. –í –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è –¥–≤–∞–∂–¥—ã –≤ –¥–µ–Ω—å
set /p choice="–í–≤–µ–¥–∏—Ç–µ 1, 2 –∏–ª–∏ 3: "

if %choice%==1 (
    goto :onlogon
) else if %choice%==2 (
    goto :hourly
) else if %choice%==3 (
    goto :daily
) else (
    echo –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –≤—ã–±–æ—Ä.
    pause
    exit /b
)

:onlogon
:: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã
schtasks /create /tn "BackupTask" /sc onlogon /rl HIGHEST /f /tr C:\startupbackupsystem\backupgood.bat /np
echo.
echo –ó–∞–¥–∞—á–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã.
:: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫–æ–ø–∏–π
echo.
echo –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –≤–µ—Å–∏—Ç –ø–æ—Ä—è–¥–∫–æ–º –ø–æ–ª—É –≥–∏–≥–∞–±–∞–π—Ç–∞. –ï—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ç–∞–∫–∂–µ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏:
echo 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞
echo 2. –ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)
echo 3. –ö–∞–∂–¥—ã–π –º–µ—Å—è—Ü
set /p clearinput="–í–≤–µ–¥–∏—Ç–µ 1, 2 –∏–ª–∏ 3: "

if %clearinput%==1 (
    goto :offclear
) else if %clearinput%==2 (
    goto :weekly
) else if %clearinput%==3 (
    goto :monthly
) else (
    echo –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –≤—ã–±–æ—Ä.
    pause
    exit /b
)

:offclear
:: –û—á–∏—Å—Ç–∫–∞ - –æ—Ç–∫–ª—é—á–µ–Ω–∞
echo.
echo –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ - –æ—Ç–∫–ª—é—á–µ–Ω–∞. –ü—É—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π C:\backup\
pause
exit /b

:weekly
:: –ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é
set /p startTime="–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MON - SUN –∏–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω [MON - SUN...]. –ö –ø—Ä–∏–º–µ—Ä—É "FRI" - –∫–∞–∂–¥—É—é –ø—è—Ç–Ω–∏—Ü—É: "
echo.
schtasks /create /tn "ClearBackupTask" /sc weekly /mo 1 /d %startTime% /st 00:00 /et 23:59 /rl HIGHEST /f /tr C:\startupbackupsystem\clearbackupgood.bat /np
echo.
echo –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∫–∞–∂–¥—ã–π %startTime%.
pause
exit /b

:monthly
:: –ö–∞–∂–¥—ã–π –º–µ—Å—è—Ü
set /p startTime="–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å –º–µ—Å—è—Ü–∞, —É–∫–∞–∑–∞–≤ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 31: "
echo.
schtasks /create /tn "ClearBackupTask" /sc monthly /mo 1 /d %startTime% /st 00:00 /et 23:59 /rl HIGHEST /f /tr C:\startupbackupsystem\clearbackupgood.bat /np
echo.
echo –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∫–∞–∂–¥—ã–π %startTime% –¥–µ–Ω—å –º–µ—Å—è—Ü–∞.
pause
exit /b

:hourly
:: –ó–∞–ø—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞
echo.
set /p startTime="–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∫–∞–∂–¥—ã–µ N —á–∞—Å–æ–≤ (–≤ –ø–µ—Ä–∏–æ–¥ –æ—Ç 1 –¥–æ 23 —á–∞—Å–æ–≤): "
echo.

:: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫–∞–∂–¥—ã–µ N —á–∞—Å–æ–≤
schtasks /create /tn "BackupTask" /sc hourly /mo %startTime% /st 00:00 /et 23:59 /k /rl HIGHEST /f /tr C:\startupbackupsystem\backupgood.bat /np
echo.
echo –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ –∫–∞–∂–¥—ã–µ %startTime% —á–∞—Å–æ–≤.
:: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫–æ–ø–∏–π
echo.
echo –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –≤–µ—Å–∏—Ç –ø–æ—Ä—è–¥–∫–æ–º –ø–æ–ª—É –≥–∏–≥–∞–±–∞–π—Ç–∞. –ï—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ç–∞–∫–∂–µ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏:
echo 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞
echo 2. –ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)
echo 3. –ö–∞–∂–¥—ã–π –º–µ—Å—è—Ü
set /p clearinput="–í–≤–µ–¥–∏—Ç–µ 1, 2 –∏–ª–∏ 3: "

if %clearinput%==1 (
    goto :offclear
) else if %clearinput%==2 (
    goto :weekly
) else if %clearinput%==3 (
    goto :monthly
) else (
    echo –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –≤—ã–±–æ—Ä.
    pause
    exit /b
)

:offclear
:: –û—á–∏—Å—Ç–∫–∞ - –æ—Ç–∫–ª—é—á–µ–Ω–∞
echo.
echo –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ - –æ—Ç–∫–ª—é—á–µ–Ω–∞. –ü—É—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π C:\backup\
pause
exit /b

:weekly
:: –ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é
set /p startTime="–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MON - SUN –∏–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω [MON - SUN...]. –ö –ø—Ä–∏–º–µ—Ä—É "FRI" - –∫–∞–∂–¥—É—é –ø—è—Ç–Ω–∏—Ü—É: "
echo.
schtasks /create /tn "ClearBackupTask" /sc weekly /mo 1 /d %startTime% /st 00:00 /et 23:59 /rl HIGHEST /f /tr C:\startupbackupsystem\clearbackupgood.bat /np
echo.
echo –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∫–∞–∂–¥—ã–π %startTime%.
pause
exit /b

:monthly
:: –ö–∞–∂–¥—ã–π –º–µ—Å—è—Ü
set /p startTime="–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å –º–µ—Å—è—Ü–∞, —É–∫–∞–∑–∞–≤ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 31: "
echo.
schtasks /create /tn "ClearBackupTask" /sc monthly /mo 1 /d %startTime% /st 00:00 /et 23:59 /rl HIGHEST /f /tr C:\startupbackupsystem\clearbackupgood.bat /np
echo.
echo –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∫–∞–∂–¥—ã–π %startTime% –¥–µ–Ω—å –º–µ—Å—è—Ü–∞.
pause
exit /b

:daily
:: –ó–∞–ø—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞
set /p startTime="–í–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (–≤ —Ñ–æ—Ä–º–∞—Ç–µ –ß–ß:–ú–ú): "
echo.
set /p startTime2="–í–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (–≤ —Ñ–æ—Ä–º–∞—Ç–µ –ß–ß:–ú–ú): "
echo.
:: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ
schtasks /create /tn "BackupTask" /sc DAILY /st %startTime% /tr C:\startupbackupsystem\backupgood.bat /rl HIGHEST /f /np
echo.
schtasks /create /tn "BackupTask2" /sc DAILY /st %startTime2% /tr C:\startupbackupsystem\backupgood.bat /rl HIGHEST /f /np
echo.
echo –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ %startTime% –∏ %startTime2% –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.
:: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫–æ–ø–∏–π
echo.
echo –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –≤–µ—Å–∏—Ç –ø–æ—Ä—è–¥–∫–æ–º –ø–æ–ª—É –≥–∏–≥–∞–±–∞–π—Ç–∞. –ï—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ç–∞–∫–∂–µ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏:
echo 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞
echo 2. –ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)
echo 3. –ö–∞–∂–¥—ã–π –º–µ—Å—è—Ü
set /p clearinput="–í–≤–µ–¥–∏—Ç–µ 1, 2 –∏–ª–∏ 3: "

if %clearinput%==1 (
    goto :offclear
) else if %clearinput%==2 (
    goto :weekly
) else if %clearinput%==3 (
    goto :monthly
) else (
    echo –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –≤—ã–±–æ—Ä.
    pause
    exit /b
)

:offclear
:: –û—á–∏—Å—Ç–∫–∞ - –æ—Ç–∫–ª—é—á–µ–Ω–∞
echo.
echo –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ - –æ—Ç–∫–ª—é—á–µ–Ω–∞. –ü—É—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π C:\backup\
pause
exit /b

:weekly
:: –ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é
set /p startTime="–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MON - SUN –∏–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω [MON - SUN...]. –ö –ø—Ä–∏–º–µ—Ä—É "FRI" - –∫–∞–∂–¥—É—é –ø—è—Ç–Ω–∏—Ü—É: "
echo.
schtasks /create /tn "ClearBackupTask" /sc weekly /mo 1 /d %startTime% /st 00:00 /et 23:59 /rl HIGHEST /f /tr C:\startupbackupsystem\clearbackupgood.bat /np
echo.
echo –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∫–∞–∂–¥—ã–π %startTime%.
pause
exit /b

:monthly
:: –ö–∞–∂–¥—ã–π –º–µ—Å—è—Ü
set /p startTime="–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å –º–µ—Å—è—Ü–∞, —É–∫–∞–∑–∞–≤ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 31: "
echo.
schtasks /create /tn "ClearBackupTask" /sc monthly /mo 1 /d %startTime% /st 00:00 /et 23:59 /rl HIGHEST /f /tr C:\startupbackupsystem\clearbackupgood.bat /np
echo.
echo –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∫–∞–∂–¥—ã–π %startTime% –¥–µ–Ω—å –º–µ—Å—è—Ü–∞.
pause
exit /b

pause

```
</details>

<details>
<summary>üîç .xml –∫–æ–¥ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏</summary>

```xml
<?xml version="1.0" encoding="UTF-16"?>
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
  <RegistrationInfo>
    <Date>2024-11-25T15:26:52</Date>
    <Author>***\***</Author>
    <URI>\BackupTask</URI>
  </RegistrationInfo>
  <Triggers>
    <LogonTrigger>
      <StartBoundary>2024-11-25T15:26:00</StartBoundary>
      <Enabled>true</Enabled>
    </LogonTrigger>
  </Triggers>
  <Principals>
    <Principal id="Author">
      <UserId>S-1-5-21-1290947932-2171505560-238677863-1001</UserId>
      <LogonType>S4U</LogonType>
      <RunLevel>HighestAvailable</RunLevel>
    </Principal>
  </Principals>
  <Settings>
    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>
    <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>
    <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>
    <AllowHardTerminate>true</AllowHardTerminate>
    <StartWhenAvailable>false</StartWhenAvailable>
    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>
    <IdleSettings>
      <Duration>PT10M</Duration>
      <WaitTimeout>PT1H</WaitTimeout>
      <StopOnIdleEnd>true</StopOnIdleEnd>
      <RestartOnIdle>false</RestartOnIdle>
    </IdleSettings>
    <AllowStartOnDemand>true</AllowStartOnDemand>
    <Enabled>true</Enabled>
    <Hidden>false</Hidden>
    <RunOnlyIfIdle>false</RunOnlyIfIdle>
    <WakeToRun>false</WakeToRun>
    <ExecutionTimeLimit>PT72H</ExecutionTimeLimit>
    <Priority>7</Priority>
  </Settings>
  <Actions Context="Author">
    <Exec>
      <Command>C:\startupbackupsystem\backupgood.bat</Command>
    </Exec>
  </Actions>
</Task>
```

</details>

---

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

* –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º –∑–∞–ø—É—Å–∫–∞: –ø—Ä–∏ –≤—Ö–æ–¥–µ, –µ–∂–µ—á–∞—Å–Ω–æ, –µ–∂–µ–¥–Ω–µ–≤–Ω–æ, –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ, –µ–∂–µ–º–µ—Å—è—á–Ω–æ;
* –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—á–∏—Å—Ç–∫–∏ –±–µ–∑ —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
* –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ Windows CLI, –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

üíª `delet autobackup.bat` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∏–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∏ –æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

```bat
@echo off
echo Batch File By MrWindows
echo.

schtasks /delete /tn "BackupTask" /f
schtasks /delete /tn "BackupTask2" /f
schtasks /delete /tn "ClearBackupTask" /f

@RD /s /q "C:\startupbackupsystem"
echo.
echo bat —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!
pause
```

---

### `backupgood.bat` ‚Äî —Å–∫—Ä–∏–ø—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

–°–æ–∑–¥–∞—ë—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ä–µ–µ—Å—Ç—Ä–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–ª—É–∂–±. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ Windows –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–∞–ª–æ–≥–æ–≤ `C:\backup`.

---

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

* `reg export` ‚Äî —ç–∫—Å–ø–æ—Ä—Ç –≤–µ—Ç–∫–∏ HKLM –≤ `.reg`-—Ñ–∞–π–ª;
* `cscript create_services_backup.vbs` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∞–º–ø–∞ —Å–ª—É–∂–± Windows;
* `net start`, `sc start` ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Å–ª—É–∂–± (`VSS`, `Remote Registry`, `Windows Backup`);
* `mkdir` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –ø–æ–¥ –∞—Ä—Ö–∏–≤ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã;
* `set`, `%date%` ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å                                             | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                   |
| ----------------------------------------------------- | -------------------------------------------------------- |
| `sc query VSS \| findstr "RUNNING" \|\| sc start VSS` | –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã —Ç–µ–Ω–µ–≤–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –µ—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞     |
| `reg export HKLM "%regBackupFile%"`                   | –≠–∫—Å–ø–æ—Ä—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ä–µ–µ—Å—Ç—Ä–∞                               |
| `cscript create_services_backup.vbs output.reg`       | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–ª—É–∂–± —á–µ—Ä–µ–∑ WMI                  |
| `set "dateStamp=%date:~0,2%.%date:~3,2%.%date:~6,4%"` | –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–∞–ø–∫–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –ø–æ –¥–∞—Ç–µ –∑–∞–ø—É—Å–∫–∞ |

---

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:**

```bat
set "backupDir=C:\backup\registry"
set "dateStamp=%date:~0,2%.%date:~3,2%.%date:~6,4%"
set "backupPath=%backupDir%\%dateStamp%"
mkdir "%backupPath%"
reg export HKLM "%backupPath%\system_registry_backup.reg"
```

<details>
<summary>üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π BAT-—Å–∫—Ä–∏–ø—Ç</summary>

```bat
rem –æ—Ç MrWindows
@echo off
@chcp 65001

echo Made by MrWindows
echo.
echo ===========================
echo Backup System Files
echo ===========================
echo.

echo ===========================
echo –ü—É—Ç—å: C:\backup\...
echo ===========================
echo.

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –≤–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Å–ª—É–∂–±
echo –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –≤–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Å–ª—É–∂–±...
echo.
echo –ó–∞–ø—É—Å–∫ Volume Shadow Copy
sc query VolSnap | findstr "RUNNING" || sc start VolSnap
echo –ó–∞–ø—É—Å–∫ Microsoft Software Shadow Copy Provider
sc query VSS | findstr "RUNNING" || sc start VSS
echo –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö Windows (Windows Backup)
net start "Windows Backup" >nul 2>&1 || net start "Windows Backup"
echo –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã (System Restore Service)
net start "System Restore Service" >nul 2>&1 || net start "System Restore Service"
echo –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã —Ç–µ–Ω–µ–≤–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–º–æ–≤ (Volume Shadow Copy Service)
net start "Volume Shadow Copy Service" >nul 2>&1 || net start "Volume Shadow Copy Service"
echo –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ä–µ–µ—Å—Ç—Ä–∞ (Remote Registry Service)
net start "Remote Registry" >nul 2>&1 || net start "Remote Registry"

echo.
echo –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Ä–µ–µ—Å—Ç—Ä–∞...

:: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Ä–µ–µ—Å—Ç—Ä–∞
set "backupDir=C:\backup\registry"
set "dateStamp=%date:~0,2%.%date:~3,2%.%date:~6,4%"
set "backupPath=%backupDir%\%dateStamp%"
mkdir "%backupPath%"

set "regBackupFile=%backupPath%\system_registry_backup.reg"
set "regBackupDir=%backupDir%"

if exist "%regBackupFile%" (
    echo –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Ä–µ–µ—Å—Ç—Ä–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º...
    del "%regBackupFile%"
)

reg export HKLM "%regBackupFile%"

echo.
echo –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Å–ª—É–∂–±...

:: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Å–ª—É–∂–±
set "servicesBackupDir=C:\backup\services"
set "servicesBackupPath=%servicesBackupDir%\%dateStamp%"
mkdir "%servicesBackupPath%"

:: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Å–ª—É–∂–±
cscript //nologo "%~dp0create_services_backup.vbs" "%servicesBackupPath%\services_backup.reg"
echo.
echo Done

```
</details>

---

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–ª—É–∂–±—ã, –≤–∫–ª—é—á–∞—è `Volume Shadow Copy`, `Remote Registry`, `System Restore Service`;
* –°–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –¥–∞—Ç–µ (`C:\backup\registry\DD.MM.YYYY`);
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ Windows, –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –ü–û;
* –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ –≤—Ä—É—á–Ω—É—é, —Ç–∞–∫ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –∑–∞–¥–∞—á, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö `autobackup.bat`;
* –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è "—Ç–∏—Ö–æ", —Ç–æ –µ—Å—Ç—å –≤ —Ñ–æ–Ω–µ.

üíª `clearbackupgood.bat` ‚Äî –¥–∞–Ω–Ω—ã–π BAT-—Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ—á–∏—Å—Ç–∫—É –∫–æ–ø–∏–π —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞.

```bat
:: –û—á–∏—Å—Ç–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
@RD /s /q "C:\backup\"
:: –ó–∞–ø—É—Å–∫ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
schtasks /run /tn "BackupTask"
echo Done
```

> \[!NOTE]
> –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ —Ä—É—á–Ω—É—é.


### `create_services_backup.vbs` ‚Äî —ç–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–ª—É–∂–± —á–µ—Ä–µ–∑ WMI

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–ª—É–∂–± Windows –≤ `.reg`-—Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ WMI. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ß—Ç–æ —Ç–∞–∫–æ–µ `.vbs`?**

Visual Basic Script (VBS) ‚Äî –≤—Å—Ç—Ä–æ–∏–º—ã–π —Å—Ü–µ–Ω–∞—Ä–Ω—ã–π —è–∑—ã–∫ Windows, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ COM/WSH. –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ `WMI` (Windows Management Instrumentation) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –û–° ‚Äî –≤ —Ç–æ–º —á–∏—Å–ª–µ –æ —Å–ª—É–∂–±–∞—Ö.

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç `batch`, VBS:

* –î–∞—ë—Ç –¥–æ—Å—Ç—É–ø –∫ `Win32_Service` —á–µ—Ä–µ–∑ `WMI`;
* –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å–ª–æ–∂–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ (—Å–ª—É–∂–±—ã, –ø—Ä–æ—Ü–µ—Å—Å—ã, —Ä–µ–µ—Å—Ç—Ä) –≤ —Ü–∏–∫–ª–∞—Ö;
* –£–º–µ–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å `.reg`-—Ñ–∞–π–ª –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

–≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ `cmd` –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–ª—É–∂–± —Å –∏—Ö —Ä–µ–∂–∏–º–∞–º–∏ –∑–∞–ø—É—Å–∫–∞ –≤ –º–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º–æ–º –≤–∏–¥–µ.

---

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

* `GetObject("winmgmts:...")` ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É `WMI`;
* `Win32_Service` ‚Äî –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª—É–∂–±;
* `StartMode ‚Üí DWORD` ‚Äî —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ —Å–ª—É–∂–± —Å —Ñ–æ—Ä–º–∞—Ç–æ–º, –ø—Ä–∏–Ω—è—Ç—ã–º –≤ —Ä–µ–µ—Å—Ç—Ä–µ;
* `OpenTextFile(..., 2, True)` ‚Äî –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é –∏ —Å–æ–∑–¥–∞–Ω–∏–µ–º.

---

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å                                  | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                       |
| ------------------------------------------ | ------------------------------------------------------------ |
| `GetObject("winmgmts:\\\\.\\root\\cimv2")` | –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ WMI –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ                  |
| `ExecQuery("Select * from Win32_Service")` | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ —Å–ª—É–∂–±                                    |
| `objService.StartMode`                     | –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–ø–∞ –∑–∞–ø—É—Å–∫–∞ (`auto`, `manual`, `disabled` –∏ —Ç.–¥.) |
| `WriteLine "[HKEY_LOCAL_MACHINE\...]"`     | –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∞ `.reg`-—Ñ–∞–π–ª–∞ –≤—Ä—É—á–Ω—É—é                      |

---

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:**

```vbscript
b.WriteLine "[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\" & objService.Name & "]"
Select Case LCase(objService.StartMode)
    Case "auto":    b.WriteLine "Start=dword:00000002"
    Case "manual":  b.WriteLine "Start=dword:00000003"
    Case "disabled":b.WriteLine "Start=dword:00000004"
End Select
```

<details>
<summary>üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π VBS-—Å–∫—Ä–∏–ø—Ç</summary>

```vbscript
Set objShell = CreateObject("WScript.Shell")
Set objFSO = CreateObject("Scripting.FileSystemObject")

Dim strBackupFile, b, strComputer, objWMIService, colListOfServices, objService
Dim iSvcCount, sShortName

strComputer = "."
iSvcCount = 0

Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
Set colListOfServices = objWMIService.ExecQuery("Select * from Win32_Service")

' –ü–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Å–ª—É–∂–± –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∫—Ä–∏–ø—Ç–∞
Set args = WScript.Arguments
If args.Count > 0 Then
    strBackupFile = args(0)
Else
    WScript.Echo "–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Å–ª—É–∂–± –Ω–µ —É–∫–∞–∑–∞–Ω."
    WScript.Quit 1
End If

Set b = objFSO.OpenTextFile(strBackupFile, 2, True)
b.WriteLine "Windows Registry Editor Version 5.00"

For Each objService In colListOfServices
    iSvcCount = iSvcCount + 1
    b.WriteLine "[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\" & objService.Name & "]"
    sShortName = LCase(objService.StartMode)
    Select Case sShortName
        Case "boot"
            b.WriteLine "Start=dword:00000000"
        Case "system"
            b.WriteLine "Start=dword:00000001"
        Case "auto"
            b.WriteLine "Start=dword:00000002"
        Case "manual"
            b.WriteLine "Start=dword:00000003"
        Case "disabled"
            b.WriteLine "Start=dword:00000004"
        Case Else
            ' –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—Ä—É–≥–∏—Ö —Å–ª—É—á–∞–µ–≤, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
    End Select
    b.WriteBlankLines 1
Next

b.Close

Set objFSO = Nothing

```
</details>

---

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

* –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –≤–µ—Ä—Å–∏—è—Ö Windows —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π WMI –∏ WSH;
* –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∫–∞–∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ —Å–ª—É–∂–±;
* –°–æ–≤–º–µ—Å—Ç–∏–º —Å —Ñ–æ—Ä–º–∞—Ç–æ–º `regedit` ‚Äî –ø–æ–ª—É—á–µ–Ω–Ω—ã–π `.reg` –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π –º–∞—à–∏–Ω–µ –∏–ª–∏ —Ü–µ–ª–µ–≤–æ–π –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –∑–∞–ø—É—Å–∫–∞ —Å–ª—É–∂–±.

---

`AutoBackupTools` –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–¥—Ö–æ–¥ –∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –ü–û.
–ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞:

* –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –¥–æ—Ä–∞–±–æ—Ç–∫–∏;
* –†–∞–±–æ—Ç–∞ —Å `Task Scheduler`, `WMI`, `VSS`, `Registry` ‚Äî –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö;
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ –∑–∞–¥–∞—á–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, –∞—É–¥–∏—Ç–∞ –∏ –∑–∞—â–∏—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π;
* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞: –æ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏, —Å –≥–∏–±–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π.

## `BatteryMaster.bat` ‚Äî –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π —á–∞—Å—Ç–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∏—Ç–∞–Ω–∏–µ–º. –í—ã–ø–æ–ª–Ω—è–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞, —Å–æ–∑–¥–∞—ë—Ç —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã, –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ö–µ–º—ã –ø–∏—Ç–∞–Ω–∏—è, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä—É—á–Ω–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –±–∞—Ç–∞—Ä–µ–∏.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —ë–º–∫–æ—Å—Ç–∏ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞, —Å–±–æ—è—Ö –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∑–∞—Ä—è–¥–∞, –Ω–∞—Ä—É—à–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–æ–≤ —Å–Ω–∞/–≥–∏–±–µ—Ä–Ω–∞—Ü–∏–∏, –ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã –±–∞—Ç–∞—Ä–µ–∏ –∏–ª–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–µ—Ç–∏.

---

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

* `powercfg /batteryreport` ‚Äî –æ—Ç—á—ë—Ç –æ —Ü–∏–∫–ª–∞—Ö, –ø—Ä–æ–µ–∫—Ç–Ω–æ–π –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —ë–º–∫–æ—Å—Ç–∏;
* `powercfg /energy` ‚Äî –≤—ã—è–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–æ–ø–∞—Ä–∞–∑–∏—Ç–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –¥—Ä–∞–π–≤–µ—Ä–æ–≤;
* `powercfg /sleepstudy` ‚Äî –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –≤ —Å–ø—è—â–∏–π —Ä–µ–∂–∏–º (–¥–ª—è —Å–∏—Å—Ç–µ–º —Å Modern Standby);
* `powercfg /restoredefaultschemes` ‚Äî —Å–±—Ä–æ—Å –≤—Å–µ—Ö —Å—Ö–µ–º –¥–æ –∑–∞–≤–æ–¥—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π;
* `sfc /scannow`, `dism /Online /Cleanup-Image /RestoreHealth` ‚Äî —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–∏—Ç–∞–Ω–∏–µ–º;
* `shutdown /h` ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ –≥–∏–±–µ—Ä–Ω–∞—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä—É—á–Ω–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏;
* `net session` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞;
* `ver | find` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –û–° –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

---

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å                               | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                                        |
| --------------------------------------- | ----------------------------------------------------------------------------- |
| `powercfg /batteryreport /output "..."` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML-–æ—Ç—á—ë—Ç–∞ –æ–± –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–µ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø—É—Ç—å                        |
| `powercfg /sleepstudy /output "..."`    | –ê–∫—Ç—É–∞–ª—å–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–∏—Å—Ç–µ–º —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Modern Standby (Windows 10/11)       |
| `shutdown /h`                           | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–ª—É–±–æ–∫–æ–π —Ä–∞–∑—Ä—è–¥–∫–∏ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ –ø—Ä–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ                |
| `setlocal enabledelayedexpansion`       | –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ —É—Å–ª–æ–≤–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –∏ —Ü–∏–∫–ª–æ–≤                |

---

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:**

```bat
powercfg /batteryreport /output "%USERPROFILE%\Desktop\battery_report.html"
powercfg /energy /output "%USERPROFILE%\Desktop\energy_report.html"
powercfg /sleepstudy /output "%USERPROFILE%\Desktop\sleepstudy_report.html"
```

<details>
<summary>üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π BAT-—Å–∫—Ä–∏–ø—Ç</summary>

```bat
@echo off
echo Batch File by MrWindows
chcp 65001 > nul

setlocal enabledelayedexpansion

color 0a
title BatteryMaster: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
mode con: cols=75 lines=25

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –û–°
ver | find "10." >nul
if %errorlevel% equ 0 set "winver=Windows 10"
ver | find "11." >nul
if %errorlevel% equ 0 set "winver=Windows 11"

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!
    echo –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
    pause
    exit /b
)

:MAIN_MENU
cls
echo.
echo ================================================
echo          BATTERYMASTER - –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ê–ö–ö–£–ú–£–õ–Ø–¢–û–†–ê
echo ================================================
echo –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: %winver%
echo ================================================
echo 1. –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ê–ö–ö–£–ú–£–õ–Ø–¢–û–†–ê
echo 2. –û–¢–ß–Å–¢ –û –°–û–°–¢–û–Ø–ù–ò–ò –ë–ê–¢–ê–†–ï–ò
echo 3. –û–¢–ö–õ–Æ–ß–ò–¢–¨ –§–£–ù–ö–¶–ò–ò –≠–ù–ï–†–ì–û–°–ë–ï–†–ï–ñ–ï–ù–ò–Ø
echo 4. –†–ï–ñ–ò–ú –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û–ô –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò
echo 5. –ö–ê–õ–ò–ë–†–û–í–ö–ê –ê–ö–ö–£–ú–£–õ–Ø–¢–û–†–ê
echo 6. –ò–°–¢–û–†–ò–Ø –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø
echo 7. –û–¢–ö–ê–¢ –ù–ê –î–ï–§–û–õ–¢–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò
echo 8. –í–´–•–û–î
echo ================================================
choice /c 12345678 /n /m "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: "
if %errorlevel% equ 1 goto DIAGNOSTICS
if %errorlevel% equ 2 goto REPORT
if %errorlevel% equ 3 goto DISABLE_ECO
if %errorlevel% equ 4 goto MAX_PERF
if %errorlevel% equ 5 goto CALIBRATION
if %errorlevel% equ 6 goto USAGE_HISTORY
if %errorlevel% equ 7 goto ROLLBACK
if %errorlevel% equ 8 exit

:DIAGNOSTICS
cls
echo –ó–ê–ü–£–°–ö –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò –ê–ö–ö–£–ú–£–õ–Ø–¢–û–†–ê...
echo.
echo –ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞—Ç–∞—Ä–µ–∏...

:: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ
powercfg /batteryreport /output "%USERPROFILE%\Desktop\Battery_Report.html" >nul

:: –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ battery report (DesignCapacity, FullChargeCapacity, CycleCount)
set count=0
for /f "tokens=2 delims=:><" %%a in ('powercfg /batteryreport /xml ^| findstr "DesignCapacity FullChargeCapacity CycleCount"') do (
    set /a count+=1
    if !count! equ 1 set design=%%a
    if !count! equ 2 set full=%%a
    if !count! equ 3 set cycles=%%a
)

if "%design%"=="" (
    echo –û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –±–∞—Ç–∞—Ä–µ–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.
    pause
    goto MAIN_MENU
)
if "%design%"=="0" (
    echo –û—à–∏–±–∫–∞: –ø—Ä–æ–µ–∫—Ç–Ω–∞—è —ë–º–∫–æ—Å—Ç—å —Ä–∞–≤–Ω–∞ 0.
    pause
    goto MAIN_MENU
)

:: –†–∞—Å—á—ë—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ (–≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö)
set /a health=100 * full / design 2>nul

echo.
echo ===== –†–ï–ó–£–õ–¨–¢–ê–¢–´ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò =====
echo –ü—Ä–æ–µ–∫—Ç–Ω–∞—è —ë–º–∫–æ—Å—Ç—å: %design% mWh
echo –¢–µ–∫—É—â–∞—è —ë–º–∫–æ—Å—Ç—å: %full% mWh
echo –¶–∏–∫–ª—ã –∑–∞—Ä—è–¥–∫–∏: %cycles%
echo –°–æ—Å—Ç–æ—è–Ω–∏–µ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞: %health%%%
if %health% lss 70 (
    echo ‚ö† –í–ù–ò–ú–ê–ù–ò–ï: –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä –∏–∑–Ω–æ—à–µ–Ω!
) else (
    echo ‚úì –°–æ—Å—Ç–æ—è–Ω–∏–µ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ –≤ –Ω–æ—Ä–º–µ.
)

:: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞—Ç–∞—Ä–µ–µ —á–µ—Ä–µ–∑ WMIC
for /f "tokens=2 delims==" %%a in ('wmic path Win32_Battery get EstimatedChargeRemaining /value ^| find "="') do set "wmic_percent=%%a"
for /f "tokens=2 delims==" %%a in ('wmic path Win32_Battery get BatteryStatus /value ^| find "="') do set "wmic_status=%%a"
for /f "tokens=2 delims==" %%a in ('wmic path Win32_Battery get EstimatedRunTime /value ^| find "="') do set "runtime=%%a"
for /f "tokens=2 delims==" %%a in ('wmic path Win32_Battery get DesignVoltage /value ^| find "="') do set "voltage=%%a"
for /f "tokens=2 delims==" %%a in ('wmic path Win32_Battery get Chemistry /value ^| find "="') do set "chemistry=%%a"

set "status_desc=–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
if "%wmic_status%"=="1" set "status_desc=–†–∞–∑—Ä—è–∂–∞–µ—Ç—Å—è"
if "%wmic_status%"=="2" set "status_desc=–ü–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ç–∏ (–Ω–µ –∑–∞—Ä—è–∂–∞–µ—Ç—Å—è)"
if "%wmic_status%"=="3" set "status_desc=–ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞—Ä—è–∂–µ–Ω"
if "%wmic_status%"=="4" set "status_desc=–ù–∏–∑–∫–∏–π –∑–∞—Ä—è–¥"
if "%wmic_status%"=="5" set "status_desc=–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∑–∞—Ä—è–¥"
if "%wmic_status%"=="6" set "status_desc=–ó–∞—Ä—è–∂–∞–µ—Ç—Å—è"
if "%wmic_status%"=="7" set "status_desc=–ó–∞—Ä—è–∂–∞–µ—Ç—Å—è (–í—ã—Å–æ–∫–∏–π –∑–∞—Ä—è–¥)"
if "%wmic_status%"=="8" set "status_desc=–ó–∞—Ä—è–∂–∞–µ—Ç—Å—è (–ù–∏–∑–∫–∏–π –∑–∞—Ä—è–¥)"
if "%wmic_status%"=="9" set "status_desc=–ó–∞—Ä—è–∂–∞–µ—Ç—Å—è (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)"
if "%wmic_status%"=="10" set "status_desc=–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ"

set "chemistry_desc=–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
if "%chemistry%"=="3" set "chemistry_desc=–°–≤–∏–Ω—Ü–æ–≤–æ-–∫–∏—Å–ª–æ—Ç–Ω–∞—è"
if "%chemistry%"=="4" set "chemistry_desc=–ù–∏–∫–µ–ª—å-–∫–∞–¥–º–∏–µ–≤–∞—è"
if "%chemistry%"=="5" set "chemistry_desc=–õ–∏—Ç–∏–π-–∏–æ–Ω–Ω–∞—è"
if "%chemistry%"=="6" set "chemistry_desc=–õ–∏—Ç–∏–π-–ø–æ–ª–∏–º–µ—Ä–Ω–∞—è"

echo.
echo ===== –ü–û–î–†–û–ë–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ë–ê–¢–ê–†–ï–ï (WMIC) =====
echo –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞: %wmic_percent%%%
echo –°—Ç–∞—Ç—É—Å –±–∞—Ç–∞—Ä–µ–∏: %wmic_status% - %status_desc%
if defined runtime (
    echo –û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: %runtime% –º–∏–Ω.
) else (
    echo –û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
)
if defined voltage (
    echo –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –±–∞—Ç–∞—Ä–µ–∏: %voltage% –º–í
)
echo –¢–∏–ø –±–∞—Ç–∞—Ä–µ–∏: %chemistry_desc%
echo.
echo –û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ: Battery_Report.html
echo.
pause
goto MAIN_MENU

:REPORT
start "" "%USERPROFILE%\Desktop\Battery_Report.html"
goto MAIN_MENU

:DISABLE_ECO
cls
echo –û–¢–ö–õ–Æ–ß–ï–ù–ò–ï –≠–ù–ï–†–ì–û–°–ë–ï–†–ï–ñ–ï–ù–ò–Ø...
echo.
:: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏—è USB
powercfg /setdcvalueindex SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 >nul
powercfg /setacvalueindex SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 >nul
echo ‚úì –û—Ç–∫–ª—é—á–µ–Ω–æ —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏–µ USB
:: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∏ —è—Ä–∫–æ—Å—Ç–∏
powercfg /setdcvalueindex SCHEME_CURRENT 7516b95f-f776-4464-8c53-06167f40cc99 fbd9aa66-9553-4097-ba44-ed6e9d65eab8 0 >nul
powercfg /setacvalueindex SCHEME_CURRENT 7516b95f-f776-4464-8c53-06167f40cc99 fbd9aa66-9553-4097-ba44-ed6e9d65eab8 0 >nul
echo ‚úì –û—Ç–∫–ª—é—á–µ–Ω–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è —è—Ä–∫–æ—Å—Ç—å
:: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–æ–≤ —Å–Ω–∏–∂–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
powercfg /setdcvalueindex SCHEME_CURRENT SUB_PROCESSOR 4b92d758-5a24-4851-a470-815d78aee119 0 >nul
powercfg /setacvalueindex SCHEME_CURRENT SUB_PROCESSOR 4b92d758-5a24-4851-a470-815d78aee119 0 >nul
echo ‚úì –û—Ç–∫–ª—é—á–µ–Ω—ã —Ç–∞–π–º–µ—Ä—ã —Å–Ω–∏–∂–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
:: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞
for /f "tokens=*" %%i in ('powershell -command "Get-NetAdapter | Where-Object {$_.Status -eq 'Up'} | Select-Object -ExpandProperty Name"') do (
    powercfg /setdcvalueindex SCHEME_CURRENT 19cbb8fa-5279-450e-9fac-8a3d5fedd0c1 12bbebe6-58d6-4636-95bb-3217ef867c1a "%%i" 0 >nul
    powercfg /setacvalueindex SCHEME_CURRENT 19cbb8fa-5279-450e-9fac-8a3d5fedd0c1 12bbebe6-58d6-4636-95bb-3217ef867c1a "%%i" 0 >nul
    echo ‚úì –û—Ç–∫–ª—é—á–µ–Ω–æ —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏–µ –¥–ª—è –∞–¥–∞–ø—Ç–µ—Ä–∞: %%i
)
:: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –¥–∏—Å–∫–æ–≤
powercfg /setdcvalueindex SCHEME_CURRENT 0012ee47-9041-4b5d-9b77-535fba8b1442 6738e2c4-e8a5-4a42-b16a-e040e769756e 0 >nul
powercfg /setacvalueindex SCHEME_CURRENT 0012ee47-9041-4b5d-9b77-535fba8b1442 6738e2c4-e8a5-4a42-b16a-e040e769756e 0 >nul
echo ‚úì –û—Ç–∫–ª—é—á–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –¥–∏—Å–∫–æ–≤
echo.
echo –í—Å–µ —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–≥–∞—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã!
echo.
pause
goto MAIN_MENU

:MAX_PERF
cls
echo –ê–ö–¢–ò–í–ê–¶–ò–Ø –†–ï–ñ–ò–ú–ê –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û–ô –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò...
echo.
:: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–ª–∞–Ω–∞ "–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"
powercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c >nul
echo ‚úì –†–µ–∂–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
echo.
:: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
powercfg /setdcvalueindex SCHEME_MIN SUB_PROCESSOR 54533251-82be-4824-96c1-47b60b740d00 100 >nul
powercfg /setacvalueindex SCHEME_MIN SUB_PROCESSOR 54533251-82be-4824-96c1-47b60b740d00 100 >nul
echo ‚úì –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
echo.
pause
goto MAIN_MENU

:CALIBRATION
cls
echo –ö–ê–õ–ò–ë–†–û–í–ö–ê –ê–ö–ö–£–ú–£–õ–Ø–¢–û–†–ê
echo.
echo –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:
echo 1. –ó–∞—Ä—è–¥–∏—Ç–µ –Ω–æ—É—Ç–±—É–∫ –¥–æ 100%.
echo 2. –û—Ç–∫–ª—é—á–∏—Ç–µ –∑–∞—Ä—è–¥–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.
echo 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ—É—Ç–±—É–∫ –¥–æ –ø–æ–ª–Ω–æ–≥–æ —Ä–∞–∑—Ä—è–¥–∞ (~5%).
echo 4. –°–Ω–æ–≤–∞ –∑–∞—Ä—è–¥–∏—Ç–µ –¥–æ 100% –±–µ–∑ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤.
echo.
echo –°–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å.
echo.
choice /c 12 /n /m "–ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥? (1-–î–∞, 2-–ù–µ—Ç): "
if %errorlevel% equ 2 goto MAIN_MENU

:MONITOR
cls
echo –ú–û–ù–ò–¢–û–†–ò–ù–ì –ö–ê–õ–ò–ë–†–û–í–ö–ò [–¥–ª—è –≤—ã—Ö–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C]
echo ================================================
echo.
for /f "tokens=2 delims==" %%a in ('wmic path Win32_Battery get EstimatedChargeRemaining /value ^| find "="') do set percent=%%a
for /f "tokens=2 delims==" %%a in ('wmic path Win32_Battery get BatteryStatus /value ^| find "="') do set state=%%a
echo –¢–µ–∫—É—â–∏–π –∑–∞—Ä—è–¥: %percent%% 
echo –°–æ—Å—Ç–æ—è–Ω–∏–µ (BatteryStatus): %state%
echo.
echo ================================================
echo.
timeout /t 5 /nobreak >nul
goto MONITOR

:USAGE_HISTORY
cls
echo –ò–°–¢–û–†–ò–Ø –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø –ê–ö–ö–£–ú–£–õ–Ø–¢–û–†–ê:
echo.
echo –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–µ—Å—Å–∏–π –±–∞—Ç–∞—Ä–µ–∏:
echo.
powercfg /batteryreport /duration 3 | findstr /i /c:"Battery usage" /c:"Duration" /c:"Energy"
echo.
echo –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ —Ñ–∞–π–ª–µ Battery_Report.html –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ.
echo.
pause
goto MAIN_MENU

:ROLLBACK
cls
echo –û–¢–ö–ê–¢ –ù–ê –î–ï–§–û–õ–¢–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò...
echo.
:: –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∏—Ç–∞–Ω–∏—è
powercfg /restoredefaultschemes >nul
echo ‚úì –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.
echo.
pause
goto MAIN_MENU

```
</details>


---

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**

1. **–§–∞–π–ª—ã –æ—Ç—á—ë—Ç–æ–≤:**

   * `battery_report.html` ‚Äî –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –æ–± –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–µ (–ø—Ä–æ–µ–∫—Ç–Ω–∞—è —ë–º–∫–æ—Å—Ç—å, –∏–∑–Ω–æ—Å, –∏—Å—Ç–æ—Ä–∏—è —Ü–∏–∫–ª–æ–≤);
   * `energy_report.html` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–±–ª–µ–º –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø–∏—Ç–∞–Ω–∏–µ–º;
   * `sleepstudy_report.html` ‚Äî –æ—Ç—á—ë—Ç –æ –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö –≤ —Ä–µ–∂–∏–º —Å–Ω–∞ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è).
     –í—Å–µ –æ—Ç—á—ë—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`%USERPROFILE%\Desktop`).

<img width="1280" height="638" alt="image" src="https://github.com/user-attachments/assets/c582b4af-6c0a-4f30-8106-3f1806d2c074" />

---

> \[!WARNING]
>
> 1. **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∑–∞—Ä—è–¥‚Äì—Ä–∞–∑—Ä—è–¥.** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `shutdown /h` —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞—Ä—è–¥–∫–∏ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞, –∏ –æ—Å—Ç–∞–≤—å—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ä–∞–∑—Ä—è–∂–∞—Ç—å—Å—è –≤ –≥–∏–±–µ—Ä–Ω–∞—Ü–∏–∏ –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∫–ª—é—á–µ–Ω–∏—è. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—É—é –∑–∞—Ä—è–¥–∫—É –±–µ–∑ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π.
> 2. **–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ö–µ–º –ø–∏—Ç–∞–Ω–∏—è (`powercfg /restoredefaultschemes`) –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ö–µ–º—ã –±—É–¥—É—Ç —É—Ç–µ—Ä—è–Ω—ã.
> 3. **–û—Ç—á—ë—Ç—ã `sleepstudy` —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö —Å Modern Standby.** –ù–∞ –¥—Ä—É–≥–∏—Ö –≤–µ—Ä—Å–∏—è—Ö Windows —Ñ–∞–π–ª —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—É—Å—Ç—ã–º.
> 4. **–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—à–∏–±–∫–∏ –≤ –æ—Ç—á—ë—Ç–∞—Ö `energy` —è–≤–ª—è—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –∏ –Ω–µ —É—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é.** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Ö –¥–ª—è –∞—É–¥–∏—Ç–∞, –Ω–µ –∫–∞–∫ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å.

## `RDP_Client_Setup.bat` –∏ `RDP_Server_Setup.bat` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ RDP-–∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
–°—Ü–µ–Ω–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–æ RDP. `RDP_Server_Setup.bat` –≤–∫–ª—é—á–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç—å: —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ñ–∞–µ—Ä–≤–æ–ª, –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–ª—É–∂–±—ã. `RDP_Client_Setup.bat` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫–ª–∏–µ–Ω—Ç–∞: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —É–¥–∞–ª—ë–Ω–Ω–æ–π –º–∞—à–∏–Ω—ã, –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –ø–æ—Ä—Ç–∞ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç —Å –∞–≤—Ç–æ—Ñ–æ–∫—É—Å–æ–º.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–∏—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º Windows (–≤ —Ä–∞–º–∫–∞—Ö —Å–µ—Ç–∏), –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏, –±—ã—Å—Ç—Ä–æ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ RDP-—Å–µ—Å—Å–∏–π, –∞ —Ç–∞–∫–∂–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º –¥–æ—Å—Ç—É–ø–∞.

–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤—Ö–æ–¥–∞:
`mstsc /v:255.255.255.255:3389`

–ì–¥–µ 255.1255.255.255 ‚Äî IPv4 —Å–µ—Ä–≤–µ—Ä–∞.

---

### `RDP_Server_Setup.bat` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ RDP

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

* `reg add HKLM\SYSTEM\...\fDenyTSConnections /d 0` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–∏—Ö RDP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π;
* `netsh advfirewall firewall add rule ... 3389` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –ø–æ—Ä—Ç–∞ RDP;
* `sc config TermService start= auto` + `net start TermService` ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å—Ç–æ–ª–æ–≤;
* `net localgroup "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞"` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É RDP;
* `wmic os get localdatetime` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ –ª–æ–≥-—Ñ–∞–π–ª–∞ —Å —Ç–µ–∫—É—â–µ–π –º–µ—Ç–∫–æ–π –≤—Ä–µ–º–µ–Ω–∏.

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å                                             | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                      |
| ----------------------------------------------------- | ----------------------------------------------------------- |
| `reg add "HKLM\SYSTEM\...\fDenyTSConnections" /d 0`   | –í–∫–ª—é—á–∞–µ—Ç –ø—Ä–∏—ë–º –≤—Ö–æ–¥—è—â–∏—Ö RDP-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ä–µ–µ—Å—Ç—Ä–∞   |
| `netsh advfirewall firewall add rule name="RDP 3389"` | –î–æ–±–∞–≤–ª—è–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –≤—Ö–æ–¥—è—â–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –ø–æ –ø–æ—Ä—Ç—É 3389 |
| `net start TermService`                               | –Ø–≤–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–ª—É–∂–±—É —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤                            |
| `net localgroup ... /add`                             | –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ RDP    |

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:**

```bat
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh advfirewall firewall add rule name="RDP 3389" dir=in action=allow protocol=TCP localport=3389
net start TermService
```

<details>
<summary>üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π BAT-—Å–∫—Ä–∏–ø—Ç</summary>

```bat
@echo off
echo Batch File by MrWindows

chcp 65001 > nul
:: chcp 1251 > nul

setlocal enabledelayedexpansion
color 0a
title RDP Server Setup (Windows 10 IoT)
mode con: cols=80 lines=30

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo [–û–®–ò–ë–ö–ê] –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!
    echo –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    pause
    exit /b
)

echo ================================================
echo    –ù–ê–°–¢–†–û–ô–ö–ê –°–ï–†–í–ï–†–ê –£–î–ê–õ–Å–ù–ù–û–ì–û –î–û–°–¢–£–ü–ê (RDP)
echo ================================================

:: –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥-—Ñ–∞–π–ª–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WMIC –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYYMMDD_HHMMSS
for /f "tokens=2 delims==." %%i in ('wmic os get localdatetime /value') do set now=%%i
set logfile=%USERPROFILE%\Desktop\RDP_Server_Log_%now:~0,8%_%now:~8,6%.txt
echo [%time%] –ù–∞—á–∞–ª–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ RDP > "%logfile%"


:: –í–∫–ª—é—á–µ–Ω–∏–µ RDP —Å–µ—Ä–≤–µ—Ä–∞
echo –í–∫–ª—é—á–µ–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞...
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f >> "%logfile%" 2>&1
if %errorlevel% neq 0 (
    echo ‚ö† –û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –≤–∫–ª—é—á–∏—Ç—å RDP —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä.
    echo [%time%] –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å –≤–∫–ª—é—á–∏—Ç—å RDP —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä >> "%logfile%"
    goto :error
)
echo [%time%] RDP —Å–µ—Ä–≤–µ—Ä –≤–∫–ª—é—á—ë–Ω –≤ —Ä–µ–µ—Å—Ç—Ä–µ >> "%logfile%"

:: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞
echo –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞...
netsh advfirewall firewall add rule name="Allow RDP" dir=in protocol=TCP localport=3389 action=allow >> "%logfile%" 2>&1
if %errorlevel% neq 0 (
    echo ‚ö† –û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –¥–ª—è RDP.
    echo [%time%] –û–®–ò–ë–ö–ê: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –Ω–µ —É–¥–∞–ª–æ—Å—å >> "%logfile%"
    goto :error
)
echo [%time%] –ü—Ä–∞–≤–∏–ª–æ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ >> "%logfile%"

:: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–æ–π TermService
echo –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã TermService...
net stop TermService >> "%logfile%" 2>&1
net start TermService >> "%logfile%" 2>&1
sc config TermService start=auto >> "%logfile%" 2>&1
if %errorlevel% neq 0 (
    echo ‚ö† –û—à–∏–±–∫–∞: –ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Å–ª—É–∂–±–æ–π TermService.
    echo [%time%] –û–®–ò–ë–ö–ê: –°–ª—É–∂–±–∞ TermService –Ω–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞ –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º >> "%logfile%"
    goto :error
)
echo [%time%] –°–ª—É–∂–±–∞ TermService –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞ >> "%logfile%"

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
echo –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π...
net user >> "%logfile%"
echo [%time%] –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤—ã–≤–µ–¥–µ–Ω >> "%logfile%"
echo.
echo –í–ê–ñ–ù–û: –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω—É–∂–µ–Ω –ø–∞—Ä–æ–ª—å!
echo       –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è —Å–≤–æ–µ–π —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏

:: –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
echo –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏...
ipconfig /all >> "%logfile%"
echo [%time%] –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã >> "%logfile%"

:: –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
echo.
echo ===== –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –°–ï–†–í–ï–†–ê =====
echo [%time%] –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ >> "%logfile%"

echo –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è RDP...
reg query "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections >> "%logfile%"
echo ‚úì –°–æ—Å—Ç–æ—è–Ω–∏–µ RDP –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ

echo –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 3389...
netstat -ano | findstr :3389 >> "%logfile%"
if %errorlevel% equ 0 (
    echo ‚úì –ü–æ—Ä—Ç 3389 –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ—Ç—Å—è
    echo [%time%] –ü–æ—Ä—Ç 3389 –∞–∫—Ç–∏–≤–µ–Ω >> "%logfile%"
) else (
    echo ‚ö† –û—à–∏–±–∫–∞: –ø–æ—Ä—Ç 3389 –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω
    echo [%time%] –û–®–ò–ë–ö–ê: –ü–æ—Ä—Ç 3389 –Ω–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ—Ç—Å—è >> "%logfile%"
)

echo –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª—É–∂–±—ã TermService...
sc query TermService | findstr "STATE" >> "%logfile%"
echo ‚úì –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ª—É–∂–±—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ

echo.
echo –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –õ–æ–≥ —Å–æ—Ö—Ä–∞–Ω—ë–Ω: %logfile%
echo IP-–∞–¥—Ä–µ—Å –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
ipconfig | findstr "IPv4" | findstr /v "127.0.0.1"
echo.
echo [%time%] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ >> "%logfile%"

:success
echo ‚úì –°–µ—Ä–≤–µ—Ä RDP –≥–æ—Ç–æ–≤ –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º
echo.
pause
exit /b

:error
echo ‚ö† –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ!
echo –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª–æ–≥-—Ñ–∞–π–ª–µ: %logfile%
pause
exit /b

```
</details>

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

* –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–ª—É–∂–±—ã –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞—ë—Ç—Å—è –ª–æ–≥ `RDP_Server_Log_YYYYMMDD_HHMMSS.txt` –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ;
* –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: —Ñ–∞–µ—Ä–≤–æ–ª, —Å–ª—É–∂–±–∞, –≥—Ä—É–ø–ø–∞ –¥–æ—Å—Ç—É–ø–∞, –ø–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏;
* –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

### `RDP_Client_Setup.bat` ‚Äî –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

* `ping`, `netstat -an` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ö–æ—Å—Ç–∞ –∏ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–∞ 3389;
* `mstsc /v:IP /f` ‚Äî –∑–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ;
* `for /f "tokens=2 delims==."` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ª–æ–≥–∞;
* `echo [%time%]` ‚Üí `>> %logfile%` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–≥–æ–≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å                                              | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                       |
| ------------------------------------------------------ | ------------------------------------------------------------ |
| `ping %remoteHost%`                                    | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ü–µ–ª–µ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ IP               |
| \`netstat -an                                          | find ":3389"\` ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Ä—Ç–∞ 3389 (–Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ) |
| `mstsc /v:%remoteHost% /f`                             | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ RDP-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ |
| `set logfile=%USERPROFILE%\Desktop\RDP_Client_Log_...` | –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π                 |

**–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:**

```bat
ping %remoteHost% >> "%logfile%"
netstat -an | find ":3389" >> "%logfile%"
mstsc /v:%remoteHost% /f
```

<details>
<summary>üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π BAT-—Å–∫—Ä–∏–ø—Ç</summary>

```bat
@echo off
echo Batch File by MrWindows

chcp 65001 > nul
:: chcp 1251 > nul

setlocal enabledelayedexpansion
color 0a
title RDP Client Setup
mode con: cols=80 lines=25

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo [–û–®–ò–ë–ö–ê] –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!
    echo –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    pause
    exit /b
)

echo ================================================
echo    –ù–ê–°–¢–†–û–ô–ö–ê –ö–õ–ò–ï–ù–¢–ê –£–î–ê–õ–Å–ù–ù–û–ì–û –î–û–°–¢–£–ü–ê (RDP)
echo ================================================

:: –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥-—Ñ–∞–π–ª–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WMIC –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYYMMDD_HHMMSS
for /f "tokens=2 delims==." %%i in ('wmic os get localdatetime /value') do set now=%%i
set logfile=%USERPROFILE%\Desktop\RDP_Client_Log_%now:~0,8%_%now:~8,6%.txt
echo [%time%] –ù–∞—á–∞–ª–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ RDP > "%logfile%"

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
echo –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤...
echo [%time%] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ >> "%logfile%"
ipconfig /all >> "%logfile%"
netsh interface show interface >> "%logfile%"
echo ‚úì –°–µ—Ç–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

:: –í–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
echo –í–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Windows...
dism /online /Enable-Feature /FeatureName:RemoteDesktopClient /All /NoRestart >> "%logfile%" 2>&1
echo [%time%] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç RemoteDesktopClient –≤–∫–ª—é—á–µ–Ω >> "%logfile%"
echo ‚úì –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã RDP –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ telnet
echo –ü—Ä–æ–≤–µ—Ä–∫–∞ telnet-–∫–ª–∏–µ–Ω—Ç–∞...
dism /online /Enable-Feature /FeatureName:TelnetClient /All /NoRestart >> "%logfile%" 2>&1
echo [%time%] Telnet Client –≤–∫–ª—é—á–µ–Ω >> "%logfile%"
echo ‚úì Telnet-–∫–ª–∏–µ–Ω—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω

:: –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç
echo.
echo ===== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ö–õ–ò–ï–ù–¢–ê =====
set /p target_ip=–í–≤–µ–¥–∏—Ç–µ IP —Ü–µ–ª–µ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: 
if "%target_ip%"=="" (
    echo [–û–®–ò–ë–ö–ê] IP-–∞–¥—Ä–µ—Å –Ω–µ –≤–≤–µ–¥—ë–Ω!
    echo [%time%] –û–®–ò–ë–ö–ê: IP-–∞–¥—Ä–µ—Å –Ω–µ –≤–≤–µ–¥—ë–Ω >> "%logfile%"
    pause
    exit /b
)
echo [%time%] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ %target_ip% >> "%logfile%"

echo.
echo –¢–µ—Å—Ç ping...
ping -n 4 %target_ip% >> "%logfile%"
if %errorlevel% equ 0 (
    echo ‚úì –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ —Å–µ—Ç–∏
    echo [%time%] –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ %target_ip% –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ ping >> "%logfile%"
) else (
    echo ‚ö† –û—à–∏–±–∫–∞: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ ping
    echo [%time%] –û–®–ò–ë–ö–ê: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ %target_ip% –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ ping >> "%logfile%"
)

echo.
echo –¢–µ—Å—Ç –ø–æ—Ä—Ç–∞ 3389...
(echo quit | telnet %target_ip% 3389) >> "%logfile%" 2>&1
if %errorlevel% equ 0 (
    echo ‚úì –ü–æ—Ä—Ç 3389 –æ—Ç–∫—Ä—ã—Ç
    echo [%time%] –ü–æ—Ä—Ç 3389 –Ω–∞ %target_ip% –¥–æ—Å—Ç—É–ø–µ–Ω >> "%logfile%"
) else (
    echo ‚ö† –û—à–∏–±–∫–∞: –ø–æ—Ä—Ç 3389 –∑–∞–∫—Ä—ã—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
    echo [%time%] –û–®–ò–ë–ö–ê: –ü–æ—Ä—Ç 3389 –Ω–∞ %target_ip% –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω >> "%logfile%"
)

echo.
echo –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –õ–æ–≥ —Å–æ—Ö—Ä–∞–Ω—ë–Ω: %logfile%
echo –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ mstsc.exe
echo.
echo [%time%] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ >> "%logfile%"
pause

```
</details>

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

* –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è IP-–∞–¥—Ä–µ—Å –∏–ª–∏ –∏–º—è —Ö–æ—Å—Ç–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è;
* –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—à–∞–≥–æ–≤—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –≤ –ª–æ–≥;
* –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è;
* –£—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ RDP-–ø–æ—Ä—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑-–∑–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫.

---

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**

–û–±–∞ —Å–∫—Ä–∏–ø—Ç–∞ –≤–µ–¥—É—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ª–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å —Ç–∞–π–º—Å—Ç–µ–º–ø–æ–º –≤ –∏–º–µ–Ω–∏, —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã–π –Ω–∞ —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```
%USERPROFILE%\Desktop\RDP_Client_Log_YYYYMMDD_HHMMSS.txt  
%USERPROFILE%\Desktop\RDP_Server_Log_YYYYMMDD_HHMMSS.txt
```

1. **–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è:**
   * –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞;
   * –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –≤ —Ñ–∞–µ—Ä–≤–æ–ª, –∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ—Ä—Ç–∞);
   * –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–º–∞–Ω–¥ `ping`, `netstat`, `reg add`, `net start` –∏ –¥—Ä.

2. **–ó–∞—á–µ–º –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è:**
   * –î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏;
   * –î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏, –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Ä—Ç –Ω–µ –æ—Ç–∫—Ä—ã—Ç, —Å–ª—É–∂–±–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è);
   * –ß—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–≥–æ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

3. **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
   * –§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏: `RDP_Client_Log_–ì–ì–ì–ì–ú–ú–î–î_–ß–ß–ú–ú–°–°.txt` ‚Äî —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `wmic os get localdatetime`;
   * –õ–æ–≥ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `echo ... >> %logfile%`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏;
   * –õ–æ–≥ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∏—Å—Ö–æ–¥–∞ ‚Äî —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–ª–∏ —Å –æ—à–∏–±–∫–æ–π.
  
<details>
<summary>üîç –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞ RDP_Server_Log</summary>

```log
[23:48:21,04] –ù–∞—á–∞–ª–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ RDP 
The operation completed successfully.

[23:48:21,08] RDP —Å–µ—Ä–≤–µ—Ä –≤–∫–ª—é—á—ë–Ω –≤ —Ä–µ–µ—Å—Ç—Ä–µ 
Ok.

[23:48:21,23] –ü—Ä–∞–≤–∏–ª–æ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ 
The following services are dependent on the  *** service.
Stopping the  *** service will also stop these services.

    ***

Do you want to continue this operation? (Y/N) [N]: The requested service has already been started.

More help is available by typing NET HELPMSG 2182.

[SC] ChangeServiceConfig SUCCESS
[23:51:03,93] –°–ª—É–∂–±–∞ TermService –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞ 

User accounts for \\ ***

-------------------------------------------------------------------------------
DefaultAccount            ***                   SyncthingServiceAcct     
WDAGUtilityAccount        ***            ***                    
The command completed successfully.

[23:51:03,97] –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤—ã–≤–µ–¥–µ–Ω 

Windows IP Configuration

   Host Name . . . . . . . . . . . . : ***
   Primary Dns Suffix  . . . . . . . : 
   Node Type . . . . . . . . . . . . : Hybrid
   IP Routing Enabled. . . . . . . . : No
   WINS Proxy Enabled. . . . . . . . : No

Ethernet adapter Ethernet:

   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : Intel(R) Ethernet Connection (2) I218-V
   Physical Address. . . . . . . . . : ***
   DHCP Enabled. . . . . . . . . . . : Yes
   Autoconfiguration Enabled . . . . : Yes
   Link-local IPv6 Address . . . . . : FFFF::FFFF:FFFF:FFFF:FFFF
   IPv4 Address. . . . . . . . . . . : 255.255.255.255
   Subnet Mask . . . . . . . . . . . : 255.255.255.255
   Lease Obtained. . . . . . . . . . : 5 ¬†¬¢¬£„°¢¬† 2025 ¬£. 15:11:12
   Lease Expires . . . . . . . . . . : 6 ¬†¬¢¬£„°¢¬† 2025 ¬£. 15:11:12
   Default Gateway . . . . . . . . . : 255.255.255.255
   DHCP Server . . . . . . . . . . . : 255.255.255.255
   DHCPv6 IAID . . . . . . . . . . . : ***
   DHCPv6 Client DUID. . . . . . . . : ***
   DNS Servers . . . . . . . . . . . : ***
                                         DoH: https://dns.google/dns-query
                                       ***
                                       255.255.255.255
   NetBIOS over Tcpip. . . . . . . . : Enabled


Ethernet adapter Ethernet 4:

   Media State . . . . . . . . . . . : Media disconnected
   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : TAP-Windows Adapter V9 #2
   Physical Address. . . . . . . . . : ***
   DHCP Enabled. . . . . . . . . . . : Yes
   Autoconfiguration Enabled . . . . : Yes

Ethernet adapter VMware Network Adapter VMnet8:

   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : VMware Virtual Ethernet Adapter for VMnet8
   Physical Address. . . . . . . . . : ***
   DHCP Enabled. . . . . . . . . . . : Yes
   Autoconfiguration Enabled . . . . : Yes
   Link-local IPv6 Address . . . . . : FFFF::FFFF:FFFF:FFFF:FFFF
   IPv4 Address. . . . . . . . . . . : 255.255.255.255
   Subnet Mask . . . . . . . . . . . : 255.255.255.255
   Lease Obtained. . . . . . . . . . : 5 ¬†¬¢¬£„°¢¬† 2025 ¬£. 15:11:27
   Lease Expires . . . . . . . . . . : 6 ¬†¬¢¬£„°¢¬† 2025 ¬£. 0:16:16
   Default Gateway . . . . . . . . . : 
   DHCP Server . . . . . . . . . . . : 255.255.255.255
   DHCPv6 IAID . . . . . . . . . . . : ***
   DHCPv6 Client DUID. . . . . . . . : ***
   Primary WINS Server . . . . . . . : 255.255.255.255
   NetBIOS over Tcpip. . . . . . . . : Enabled

Ethernet adapter vEthernet (Default Switch):

   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : Hyper-V Virtual Ethernet Adapter
   Physical Address. . . . . . . . . : FF-FF-FF-FF-FF-FF
   DHCP Enabled. . . . . . . . . . . : No
   Autoconfiguration Enabled . . . . : Yes
   Link-local IPv6 Address . . . . . : FFFF::FFFF:FFFF:FFFF:FFFF
   IPv4 Address. . . . . . . . . . . : 255.255.255.255
   Subnet Mask . . . . . . . . . . . : 255.255.255.255
   Default Gateway . . . . . . . . . : 
   DHCPv6 IAID . . . . . . . . . . . : ***
   DHCPv6 Client DUID. . . . . . . . : ***
   NetBIOS over Tcpip. . . . . . . . : Enabled
[23:51:04,01] –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã 
[23:51:04,02] –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ 

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server
    fDenyTSConnections    REG_DWORD    0x0

  TCP    0.0.0.0:3389           0.0.0.0:0              LISTENING       1344
  TCP    [::]:3389              [::]:0                 LISTENING       1344
  UDP    0.0.0.0:3389           *:*                                    1344
  UDP    [::]:3389              *:*                                    1344
[23:51:04,07] –ü–æ—Ä—Ç 3389 –∞–∫—Ç–∏–≤–µ–Ω 
        STATE              : 4  RUNNING 
[23:51:04,12] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ 

```

</details>

<details>
<summary>üîç –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞ RDP_Client_Log</summary>

```log
[23:47:32,57] –ù–∞—á–∞–ª–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ RDP 
[23:47:32,57] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ 

Windows IP Configuration

   Host Name . . . . . . . . . . . . : ***
   Primary Dns Suffix  . . . . . . . : 
   Node Type . . . . . . . . . . . . : Hybrid
   IP Routing Enabled. . . . . . . . : No
   WINS Proxy Enabled. . . . . . . . : No

Ethernet adapter Ethernet:

   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : Intel(R) Ethernet Connection (2) I218-V
   Physical Address. . . . . . . . . : ***
   DHCP Enabled. . . . . . . . . . . : Yes
   Autoconfiguration Enabled . . . . : Yes
   Link-local IPv6 Address . . . . . : FFFF::FFFF:FFFF:FFFF:FFFF
   IPv4 Address. . . . . . . . . . . : 255.255.255.255
   Subnet Mask . . . . . . . . . . . : 255.255.255.255
   Lease Obtained. . . . . . . . . . : 5 ¬†¬¢¬£„°¢¬† 2025 ¬£. 15:11:12
   Lease Expires . . . . . . . . . . : 6 ¬†¬¢¬£„°¢¬† 2025 ¬£. 15:11:12
   Default Gateway . . . . . . . . . : 255.255.255.255
   DHCP Server . . . . . . . . . . . : 255.255.255.255
   DHCPv6 IAID . . . . . . . . . . . : ***
   DHCPv6 Client DUID. . . . . . . . : ***
   DNS Servers . . . . . . . . . . . : ***
                                         DoH: https://dns.google/dns-query
                                       ***
                                       255.255.255.255
   NetBIOS over Tcpip. . . . . . . . : Enabled


Ethernet adapter Ethernet 4:

   Media State . . . . . . . . . . . : Media disconnected
   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : TAP-Windows Adapter V9 #2
   Physical Address. . . . . . . . . : ***
   DHCP Enabled. . . . . . . . . . . : Yes
   Autoconfiguration Enabled . . . . : Yes

Ethernet adapter VMware Network Adapter VMnet8:

   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : VMware Virtual Ethernet Adapter for VMnet8
   Physical Address. . . . . . . . . : ***
   DHCP Enabled. . . . . . . . . . . : Yes
   Autoconfiguration Enabled . . . . : Yes
   Link-local IPv6 Address . . . . . : FFFF::FFFF:FFFF:FFFF:FFFF
   IPv4 Address. . . . . . . . . . . : 255.255.255.255
   Subnet Mask . . . . . . . . . . . : 255.255.255.255
   Lease Obtained. . . . . . . . . . : 5 ¬†¬¢¬£„°¢¬† 2025 ¬£. 15:11:27
   Lease Expires . . . . . . . . . . : 6 ¬†¬¢¬£„°¢¬† 2025 ¬£. 0:16:16
   Default Gateway . . . . . . . . . : 
   DHCP Server . . . . . . . . . . . : 255.255.255.255
   DHCPv6 IAID . . . . . . . . . . . : ***
   DHCPv6 Client DUID. . . . . . . . : ***
   Primary WINS Server . . . . . . . : 255.255.255.255
   NetBIOS over Tcpip. . . . . . . . : Enabled

Ethernet adapter vEthernet (Default Switch):

   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : Hyper-V Virtual Ethernet Adapter
   Physical Address. . . . . . . . . : FF-FF-FF-FF-FF-FF
   DHCP Enabled. . . . . . . . . . . : No
   Autoconfiguration Enabled . . . . : Yes
   Link-local IPv6 Address . . . . . : FFFF::FFFF:FFFF:FFFF:FFFF
   IPv4 Address. . . . . . . . . . . : 255.255.255.255
   Subnet Mask . . . . . . . . . . . : 255.255.255.255
   Default Gateway . . . . . . . . . : 
   DHCPv6 IAID . . . . . . . . . . . : ***
   DHCPv6 Client DUID. . . . . . . . : ***
   NetBIOS over Tcpip. . . . . . . . : Enabled

Admin State    State          Type             Interface Name
-------------------------------------------------------------------------
Enabled        Disconnected   Dedicated        Ethernet 2
Enabled        Disconnected   Dedicated        OpenVPN Data Channel Offload
Enabled        Disconnected   Dedicated        Ethernet 4
Enabled        Connected      Dedicated        VMware Network Adapter VMnet1
Enabled        Connected      Dedicated        VMware Network Adapter VMnet8
Enabled        Connected      Dedicated        Ethernet


Deployment Image Servicing and Management tool
Version: 10.0.22621.2792

Image Version: 10.0.22631.5624


Error: 0x800f080c

¬à¬¨Ô†™¬Æ¬¨¬Ø¬Æ¬≠¬•¬≠‚††"RemoteDesktopClient" ¬≠¬•¬®¬ß¬¢¬•·¢≠¬Æ.
¬à¬¨Ô†™¬Æ¬¨¬Ø¬Æ¬≠¬•¬≠‚††Windows ¬≠¬• ‡†°¬Ø¬Æ¬ß¬≠¬†¬≠¬Æ.
¬Ç¬Æ·ØÆ¬´Ïß£¬©‚•°Ï†Ø¬†‡†¨¬•‚†Æ¬¨ /Get-Features, Á¢Æ¬°Î†≠¬†¬©‚®†¬®¬¨Ô†™¬Æ¬¨¬Ø¬Æ¬≠¬•¬≠‚††¬¢ ¬Æ¬°‡†ß¬•, ¬® ¬Ø¬Æ¬¢‚Æ†¬®‚•†¬™¬Æ¬¨¬†¬≠¬§„Æç

The DISM log file can be found at C:\Windows\Logs\DISM\dism.log
[23:47:33,06] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç RemoteDesktopClient –≤–∫–ª—é—á–µ–Ω 

Deployment Image Servicing and Management tool
Version: 10.0.22621.2792

Image Version: 10.0.22631.5624

¬Ç¬™¬´Óß•¬≠¬®¬• ‰£≠¬™Ê®©

[                           0.1%                           ] 

[=======                    12.5%                          ] 

[========                   15.0%                          ] 

[==========                 17.5%                          ] 

[===========                20.0%                          ] 

[=============              22.5%                          ] 

[==============             25.0%                          ] 

[===============            27.5%                          ] 

[=================          30.0%                          ] 

[==================         31.7%                          ] 

[===================        33.4%                          ] 

[==========================100.0%==========================] 
The operation completed successfully.
[23:47:44,00] Telnet Client –≤–∫–ª—é—á–µ–Ω 
[23:48:01,58] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ***

Pinging 192.168.0.1 with 32 bytes of data:
Request timed out.
Request timed out.
Request timed out.
Request timed out.

Ping statistics for 192.168.0.1:
    Packets: Sent = 4, Received = 0, Lost = 4 (100% loss),
[23:48:20,32] –û–®–ò–ë–ö–ê: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ *** –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ ping 
[23:48:20,36] –û–®–ò–ë–ö–ê: –ü–æ—Ä—Ç 3389 –Ω–∞ 192.168.0.1 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω 
[23:48:20,36] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ 

```

</details>

> \[!WARNING]
>
> 1. –ù–∞ Home-—Ä–µ–¥–∞–∫—Ü–∏—è—Ö Windows —Å–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å RDP –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∞ Windows Pro/IoT/Enterprise.
> 2. –î–ª—è —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –ø–æ—Ä—Ç 3389 –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å–µ—Ç–∏. –û—Ç–∫–ª—é—á—ë–Ω–Ω—ã–π —Ñ–∞–µ—Ä–≤–æ–ª –∏–ª–∏ –ø—Ä–æ–±—Ä–æ—à–µ–Ω–Ω—ã–π NAT ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã.
> 3. –°–ª—É–∂–±–∞ TermService –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω–∞. –í —Ä—è–¥–µ —Å–ª—É—á–∞–µ–≤ –µ—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø–æ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏.
> 4. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –≤ UAC. –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç—Ä–µ–±—É—é—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

## üßæ –°–±–æ—Ä –ª–æ–≥–æ–≤ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ WiLogUtl

–°–∫—Ä–∏–ø—Ç: `log_dumper.bat`:
```bat
@echo off
set LOGPATH="%USERPROFILE%\Desktop\OfficeInstall.log"
msiexec /i "C:\MS_Office_2010\MS_Office_2010\setup.exe" /L*v %LOGPATH%
pause
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
–°—Ü–µ–Ω–∞—Ä–∏–π –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–±–æ—Ä–∞ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã—Ö –ª–æ–≥–æ–≤ Windows Installer (MSI), —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ —Å–æ–±—ã—Ç–∏–π Windows. –§–æ—Ä–º–∏—Ä—É–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –∞—Ä—Ö–∏–≤, –ø—Ä–∏–≥–æ–¥–Ω—ã–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å –ø–æ–º–æ—â—å—é `WiLogUtl` –∏ –¥—Ä—É–≥–∏—Ö —É—Ç–∏–ª–∏—Ç. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∞—É–¥–∏—Ç–∞ –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ü–û.

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
- –ü—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º;
- –î–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ª–æ–≥–æ–≤ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ L2/L3;
- –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä—É—á–Ω–æ–≥–æ/–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –ü–û;
- –ü—Ä–∏ —Å–±–æ—è—Ö, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å MSI, `setup.exe`, `msiexec`.

---

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å                                                       | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—è—Å–Ω–µ–Ω–∏–µ                                                                 |
|------------------------------------------------------------------|----------------------------------------------------------------------------------------|
| `set LOGPATH="%USERPROFILE%\Desktop\OfficeInstall.log"`          | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å—Ä–µ–¥—ã –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –ø—É—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–æ–≥–æ –ª–æ–≥–∞                      |
| `msiexec /i "C:\Path\to\setup.msi" /L*v %LOGPATH%`               | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MSI-–ø–∞–∫–µ—Ç–∞ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º (`/L*v`) –≤ —Ñ–∞–π–ª `OfficeInstall.log`               |
| `/L*v`                                                           | –ö–ª—é—á –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è, –æ—à–∏–±–∫–∏, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (`verbose`)     |


**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `msiexec`;
- –°–æ–∑–¥–∞—ë—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ MSI-–ø–∞–∫–µ—Ç–∞ –ø–æ –ø—É—Ç–∏:  
  `%USERPROFILE%\Desktop\OfficeInstall.log`;
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫;
- –ü—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏.

## –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–µ—Ä–µ–∑ WiLogUtl
–°–æ–∑–¥–∞–Ω–Ω—ã–π –ª–æ–≥-—Ñ–∞–π–ª —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (`OfficeInstall.log`) –º–æ–∂–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π —É—Ç–∏–ª–∏—Ç—ã –æ—Ç Microsoft ‚Äî **WiLogUtl.exe**.

**–ß—Ç–æ —Ç–∞–∫–æ–µ WiLogUtl?**

**WiLogUtl** ‚Äî —ç—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—à–∞–≥–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ MSI-—É—Å—Ç–∞–Ω–æ–≤–∫–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—ã –æ—à–∏–±–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: `Error 1603`, —Å–±–æ–∏ —É—Å–ª–æ–≤–∏–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏, –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ —Ç.–¥.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ WiLogUtl

WiLogUtl –≤—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–∞–≤ **Windows SDK**.

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç:  
   [https://developer.microsoft.com/en-us/windows/downloads/sdk-archive](https://developer.microsoft.com/en-us/windows/downloads/sdk-archive)
2. –°–∫–∞—á–∞–π—Ç–µ –≤–µ—Ä—Å–∏—é Windows SDK, —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é —Å –≤–∞—à–µ–π –û–°.
3. –í–æ –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ **–≤—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ª—å–∫–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç: "Debugging Tools for Windows"** ‚Äî —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.

> –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ WiLogUtl –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –ø—É—Ç–∏:
> ```
> C:\Program Files (x86)\Windows Kits\10\bin\10.0.xxxxx.x\x86\WiLogUtl.exe
> ```

---

## üìÇ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `WiLogUtl.exe`
2. –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –ª–æ–≥-—Ñ–∞–π–ª—É, —Å–æ–∑–¥–∞–Ω–Ω–æ–º—É —Å–∫—Ä–∏–ø—Ç–æ–º:
3. –ù–∞–∂–∞—Ç—å "Analyze" ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –¥–µ—Ä–µ–≤–æ —à–∞–≥–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏.

<img width="665" height="549" alt="image" src="https://github.com/user-attachments/assets/c446a821-695a-43d8-ab2b-7cd489e7c068" />

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º **WiLogUtl** –ø—Ä–æ–≤–æ–¥–∏—Ç –ø–∞—Ä—Å–∏–Ω–≥ –ª–æ–≥–∞, –≥–¥–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç:
- –û—Å–Ω–æ–≤–Ω—ã–µ –æ—à–∏–±–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: ` –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º: 1603.`
- –î—Ä—É–≥–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ `Client Details` –∏ `Server Details`

–î–∞–ª–µ–µ –º—ã –º–æ–∂–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–∏–¥–µ `.txt` –∏–ª–∏ `.html` —Ñ–æ—Ä–º–∞—Ç–∞. –û–Ω–∏ –ø–æ–¥–æ–π–¥—É—Ç –¥–ª—è –æ—Ç—á—ë—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–¥–µ—Ä–∂–∞—Ç—å: `log_Errors`, `log_Policies` –∏ `log_Summary`

<img width="2560" height="957" alt="msedge_BxQPHyMfPC" src="https://github.com/user-attachments/assets/69c3b43a-fb2c-4494-b57b-14276f5d98ed" />

<details>
<summary>üîç –ü—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ª–æ–≥–∞</summary>

```txt
Errors Found For Log File D:\Office\logs\2\OfficeInstall.log
======================================================

4 Non-Ignored Errors
======================================================
-------------------------------------------------
Believed Error Found:

Error 1713. Setup cannot install one of the required products for Microsoft Office Professional Plus 2010.  
MSI (s) (00!F8) [20:06:45:443]: Product: Microsoft Office Professional Plus 2010 -- Error 1713. Setup cannot install one of the required products for Microsoft Office Professional Plus 2010.  

CustomAction AbortMsi returned actual error code 1603 (note this may not be 100% accurate if translation happened inside sandbox)
Action ended 20:06:45: AbortMsi. Return value 3.


Proposed Solution To Error:
  A standard action or custom action caused the failure.

-------------------------------------------------
Believed Error Found:
Error 1713. Setup cannot install one of the required products for Microsoft Office Professional Plus 2010.  
MSI (s) (00!F8) [20:06:45:443]: Product: Microsoft Office Professional Plus 2010 -- Error 1713. Setup cannot install one of the required products for Microsoft Office Professional Plus 2010.  

CustomAction AbortMsi returned actual error code 1603 (note this may not be 100% accurate if translation happened inside sandbox)
Action ended 20:06:45: AbortMsi. Return value 3.
Action ended 20:06:45: INSTALL. Return value 3.


Proposed Solution To Error:
  A standard action or custom action caused the failure.

-------------------------------------------------
Believed Error Found:
MSI (s) (00:98) [20:06:45:521]: Restoring environment variables
MSI (s) (00:98) [20:06:45:521]: Destroying RemoteAPI object.
MSI (s) (00:B4) [20:06:45:521]: Custom Action Manager thread ending.
MSI (c) (04:DC) [20:06:45:537]: Back from server. Return value: 1603
MSI (c) (04:DC) [20:06:45:537]: Decrementing counter to disable shutdown. If counter >= 0, shutdown will be denied.  Counter after decrement: -1
Action ended 20:06:45: INSTALL. Return value 3.


Proposed Solution To Error:
  A standard action or custom action caused the failure.

-------------------------------------------------
Believed Error Found:

MSI (c) (04:DC) [20:06:45:552]:            Windows                            .        : Microsoft Office Professional Plus 2010.       : 14.0.4763.1000.     : 0.             : Microsoft Corporation.                                 : 1603.

MSI (c) (04:DC) [20:06:45:568]: Grabbed execution mutex.
MSI (c) (04:DC) [20:06:45:568]: Cleaning up uninstalled install packages, if any exist
MSI (c) (04:DC) [20:06:45:568]: MainEngineThread is returning 1603


Proposed Solution To Error:
                                                    .



0 Ignored Errors
======================================================
-------------------------------------------------
Believed Error Found:
No Error Found!

Proposed Solution To Error:
  No Solution Needed!


```

</details>

### –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö

- **–û—à–∏–±–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏**: `Error 1603`, `Error 1935`, `Access Denied`
- **–ü—Ä–µ—Ä–≤–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è**: –∑–∞–ø–∏—Å–∏ —Ç–∏–ø–∞ `Rolling back action`
- **–û—à–∏–±–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞**: —Å—Ç—Ä–æ–∫–∏ —Å `Denied`, `Permission`, `Impersonate`
- **–¶–∏–∫–ª—ã –∏ —É—Å–ª–æ–≤–∏—è**: –ª–æ–≥–∏–∫–∞ `Condition Failed`, `Skipped`

### ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è WiLogUtl

- –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–≤–Ω–µ—à–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏** ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–º, –≤–Ω–µ—à–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, —Å–µ—Ç–µ–≤—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.
- –ù–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –≤–Ω–µ MSI**, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤, –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∫–æ–º–∞–Ω–¥ –æ–±–æ–ª–æ—á–∫–∏.
- –ù–µ –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å `.etl`, `.cab` –∏–ª–∏ –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ ‚Äî —Ç–æ–ª—å–∫–æ `MSI .log`.
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –±–æ–ª—å—à–∏—Ö –ª–æ–≥–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—É–¥–æ–±–µ–Ω.

### üß∞ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç         | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤         | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                                       |
|--------------------|----------------------------|--------------------------------------------------------------------|
| **Microsoft Log Parser 2.2** | –ª—é–±–∞—è —Ç–µ–∫—Å—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞, `.log`, CSV, Event Log, —Ä–µ–µ—Å—Ç—Ä :contentReference[oaicite:2]{index=2} | SQL‚Äë–ø–æ–¥–æ–±–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ª–æ–≥–∞–º, —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º `.log`               |
| **CMTrace.exe**    | —Ç–µ–∫—Å—Ç–æ–≤—ã–µ `.log`, –≤–∫–ª—é—á–∞—è MSI –∏ custom logs :contentReference[oaicite:3]{index=3} | –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –æ—à–∏–±–æ–∫, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ø—Ä–æ—Å–º–æ—Ç—Ä –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏           |
| **LogGrok**        | MSI-–ª–æ–≥–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ `.log` (open-source) :contentReference[oaicite:4]{index=4} | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è, regex, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–π—Å—Ç–≤–∏–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ |

### üìò –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ WiLogUtl](https://learn.microsoft.com/en-us/windows/win32/msi/wilogutl-exe)
- [–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ MSI –æ—à–∏–±–æ–∫ (Error Codes)](https://learn.microsoft.com/en-us/windows/win32/msi/error-codes)

---

üìå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `log_dumper.bat` –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å WiLogUtl –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **—É–º–µ–Ω–∏–µ —Å–æ–±–∏—Ä–∞—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ –ª–æ–≥–∏** ‚Äî –≤–∞–∂–Ω—ã–π –Ω–∞–≤—ã–∫ –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏

